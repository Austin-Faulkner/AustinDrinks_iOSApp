WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'confluence.extra.jira:jim-fabric-editor-support', location = 'editor-plugins/jira-paste-link.js' */
define("confluence/jim/editor-plugins/jira-paste-link",["ajs","confluence-macro-browser/macro-browser-facade"],function(b,c){var a={issueKeyOnlyRegEx:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/,singleTicketXMLEx:/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,issueKeyWithinRegex:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)(?:\?|#)/,jqlRegEx:/jqlQuery\=([^&]+)/,jqlRegExAlternateFormat:/jql\=([^&]+)/,_getMatchedServerFromLink:function(e,k){var j=null;for(var g in k){if(k.hasOwnProperty(g)){var h=k[g];var d=h.url;var f=h.url[h.url.length-1];if(f!=="/"){d+="/"}if(e.indexOf(d)===0){j=h;break}}}return j},pasteHandler:function(h,i,l){var n=b.Editor.JiraConnector.servers;if(!n){l();return null}var m=b.Editor.JiraAnalytics;var g={};var o=a._getMatchedServerFromLink(h.source,n);var j=null;if(o){var e=a.jqlRegEx.exec(h.source)||a.jqlRegExAlternateFormat.exec(h.source);var d=b.JQLHelper.isFilterUrl(h.source);var k=a.issueKeyOnlyRegEx.exec(h.source)||a.issueKeyWithinRegex.exec(h.source);if(k){k=k[2];if(m){g.type=m.linkTypes.jql}}else{k=a.singleTicketXMLEx.exec(h.source);if(k){k=k[1];if(m){g.type=m.linkTypes.xml}}}if(e){g.is_single_issue=false;g.type=b.JQLHelper.checkQueryType(h.source);j={name:"jira",params:{jqlQuery:decodeURIComponent(e[1].replace(/\+/g,"%20")),server:o.name,serverId:o.id}}}else{if(d){var f=h.source;g.is_single_issue=false;g.type=b.JQLHelper.checkQueryType(f);j={name:"jira",params:{jqlQuery:b.JQLHelper.getFilterFromFilterUrl(f),server:o.name,serverId:o.id}}}else{if(k){g.is_single_issue=true;j={name:"jira",params:{key:k,server:o.name,serverId:o.id}}}}}}if(c.isInTinyMceEditor()){if(j){window.tinymce.plugins.Autoconvert.convertMacroToDom(j,l,l);if(m){m.triggerPasteEvent(g)}}else{l()}}else{return j}}};return a});
}catch(e){WRMCB(e)};