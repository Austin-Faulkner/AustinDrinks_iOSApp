WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:connect-host-v5', location = 'v5/js/core/connect-host.js' */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).connectHost=t()}(this,(function(){"use strict";var e=function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t};function t(){}t.prototype=Object.create(null);function n(){n.init.call(this)}n.EventEmitter=n;n.usingDomains=!1;n.prototype.domain=void 0;n.prototype._events=void 0;n.prototype._maxListeners=void 0;n.defaultMaxListeners=10;n.init=function(){this.domain=null;n.usingDomains&&undefined.active;if(!this._events||this._events===Object.getPrototypeOf(this)._events){this._events=new t;this._eventsCount=0}this._maxListeners=this._maxListeners||void 0};n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');this._maxListeners=e;return this};function i(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}n.prototype.getMaxListeners=function(){return i(this)};function o(e,t,n){if(t)e.call(n);else for(var i=e.length,o=f(e,i),r=0;r<i;++r)o[r].call(n)}function r(e,t,n,i){if(t)e.call(n,i);else for(var o=e.length,r=f(e,o),a=0;a<o;++a)r[a].call(n,i)}function a(e,t,n,i,o){if(t)e.call(n,i,o);else for(var r=e.length,a=f(e,r),s=0;s<r;++s)a[s].call(n,i,o)}function s(e,t,n,i,o,r){if(t)e.call(n,i,o,r);else for(var a=e.length,s=f(e,a),d=0;d<a;++d)s[d].call(n,i,o,r)}function d(e,t,n,i){if(t)e.apply(n,i);else for(var o=e.length,r=f(e,o),a=0;a<o;++a)r[a].apply(n,i)}n.prototype.emit=function(e){var t,n,i,c,l,u,f,p="error"===e;if(u=this._events)p=p&&null==u.error;else if(!p)return!1;f=this.domain;if(p){t=arguments[1];if(!f){if(t instanceof Error)throw t;var g=new Error('Uncaught, unspecified "error" event. ('+t+")");g.context=t;throw g}t||(t=new Error('Uncaught, unspecified "error" event'));t.domainEmitter=this;t.domain=f;t.domainThrown=!1;f.emit("error",t);return!1}if(!(n=u[e]))return!1;var h="function"==typeof n;switch(i=arguments.length){case 1:o(n,h,this);break;case 2:r(n,h,this,arguments[1]);break;case 3:a(n,h,this,arguments[1],arguments[2]);break;case 4:s(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:c=new Array(i-1);for(l=1;l<i;l++)c[l-1]=arguments[l];d(n,h,this,c)}return!0};function c(e,n,o,r){var a,s,d,c;if("function"!=typeof o)throw new TypeError('"listener" argument must be a function');if(s=e._events){if(s.newListener){e.emit("newListener",n,o.listener?o.listener:o);s=e._events}d=s[n]}else{s=e._events=new t;e._eventsCount=0}if(d){"function"==typeof d?d=s[n]=r?[o,d]:[d,o]:r?d.unshift(o):d.push(o);if(!d.warned&&(a=i(e))&&a>0&&d.length>a){d.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+d.length+" "+n+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning";l.emitter=e;l.type=n;l.count=d.length;c=l,"function"==typeof console.warn?console.warn(c):console.log(c)}}else{d=s[n]=o;++e._eventsCount}return e}n.prototype.addListener=function(e,t){return c(this,e,t,!1)};n.prototype.on=n.prototype.addListener;n.prototype.prependListener=function(e,t){return c(this,e,t,!0)};function l(e,t,n){var i=!1;function o(){e.removeListener(t,o);if(!i){i=!0;n.apply(e,arguments)}}o.listener=n;return o}n.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');this.on(e,l(this,e,t));return this};n.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');this.prependListener(e,l(this,e,t));return this};n.prototype.removeListener=function(e,n){var i,o,r,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if(!(o=this._events))return this;if(!(i=o[e]))return this;if(i===n||i.listener&&i.listener===n)if(0==--this._eventsCount)this._events=new t;else{delete o[e];o.removeListener&&this.emit("removeListener",e,i.listener||n)}else if("function"!=typeof i){r=-1;for(a=i.length;a-- >0;)if(i[a]===n||i[a].listener&&i[a].listener===n){s=i[a].listener;r=a;break}if(r<0)return this;if(1===i.length){i[0]=void 0;if(0==--this._eventsCount){this._events=new t;return this}delete o[e]}else!function(e,t){for(var n=t,i=n+1,o=e.length;i<o;n+=1,i+=1)e[n]=e[i];e.pop()}(i,r);o.removeListener&&this.emit("removeListener",e,s||n)}return this};n.prototype.removeAllListeners=function(e){var n,i;if(!(i=this._events))return this;if(!i.removeListener){if(0===arguments.length){this._events=new t;this._eventsCount=0}else i[e]&&(0==--this._eventsCount?this._events=new t:delete i[e]);return this}if(0===arguments.length){for(var o,r=Object.keys(i),a=0;a<r.length;++a)"removeListener"!==(o=r[a])&&this.removeAllListeners(o);this.removeAllListeners("removeListener");this._events=new t;this._eventsCount=0;return this}if("function"==typeof(n=i[e]))this.removeListener(e,n);else if(n)do{this.removeListener(e,n[n.length-1])}while(n[0]);return this};n.prototype.listeners=function(e){var t,n,i=this._events;n=i&&(t=i[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[];return n};n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):u.call(e,t)};n.prototype.listenerCount=u;function u(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}n.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function f(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}var p,g=function(t){e(n,t);function n(){var e;(e=t.call(this)||this).setMaxListeners(20);return e}var i=n.prototype;i.dispatch=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.emit.apply(this,["before:"+e].concat(n));this.emit.apply(this,arguments);this.emit.apply(this,["after:"+e].concat(n))};i.registerOnce=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.once(e,t)};i.register=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.on(e,t)};i.unregister=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.removeListener(e,t)};return n}(n),h=new g,m=window.AJS&&window.AJS.$||function(){},y=[];if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window){var v=new IntersectionObserver((function(e){e.forEach((function(e){var t=e.intersectionRatio,n=e.target;if(t>0){v.unobserve(n);!function(e){y=y.filter((function(t){var n=t.element,i=t.callback;if(n===e){i();return!1}return!0}))}(n)}}))}),{threshold:.25});p=v.observe.bind(v)}function _(e){if(AJS&&AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled&&AJS.DarkFeatures.isEnabled(e))return!0;var t=window.featureFlags||AJS&&AJS.Meta&&AJS.Meta.get&&AJS.Meta.get("fe-feature-flags");if(!t)return!1;var n={};try{n="object"==typeof t?t:JSON.parse(t)}catch(e){return!1}return!(!n[e]||"boolean"!=typeof n[e].value)&&n[e].value}var x=function(){function e(){this._addons={}}var t=e.prototype;t._track=function(e,t){var n=window,i="connect.addon."+e;(t=t||{}).version=n._AP&&n._AP.version?n._AP.version:void 0;t.userAgent=n.navigator.userAgent;if(!n.AJS)return!1;if(n.AJS.Analytics)n.AJS.Analytics.triggerPrivacyPolicySafeEvent(i,t);else{if(!n.AJS.trigger)return!1;AJS.trigger("analyticsEvent",{name:i,data:t})}return!0};t._trackGasV3=function(e,t){try{window.require("ac/analytics").emitGasV3(e,t)}catch(e){console.info("Connect GasV3 catch",e)}};t._time=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()};t.trackLoadingStarted=function(e){if(this._addons&&e&&e.id){e.startLoading=this._time();this._addons[e.id]=e}else console.error("ACJS: cannot track loading analytics",this._addons,e)};t.trackLoadingEnded=function(e){var t=this;if(this._addons&&e&&this._addons[e.id]){var n,i=e.url,o=void 0!==i&&-1===i.indexOf("xdm_e="),r=this._time()-this._addons[e.id].startLoading,a=this.getIframeLoadApdex(r);try{n=Object.keys(JSON.parse(this._addons[e.id].$el[0].name).api).sort().toString()}catch(e){n="error"}var s={addonKey:e.addon_key,moduleKey:e.key,moduleType:e.options?e.options.moduleType:void 0,moduleLocation:e.options?e.options.moduleLocation:void 0,pearApp:e.options&&"true"===e.options.pearApp?"true":"false",iframeLoadMillis:r,iframeLoadApdex:a,iframeIsCacheable:o,value:r>2e4?"x":Math.ceil(r/100),api:n};"function"==typeof window.requestIdleCallback?window.requestIdleCallback((function(){return t._track("iframe.performance.load",s)}),{timeout:100}):this._track("iframe.performance.load",s)}else console.error("ACJS: cannot track loading end analytics",this._addons,e)};t.getIframeLoadApdex=function(e){return e<=300?1:e<=1200?.5:0};t.trackLoadingTimeout=function(e){var t=window.navigator.onLine;"boolean"!=typeof t&&(t="not-supported");this._track("iframe.performance.timeout",{addonKey:e.addon_key,moduleKey:e.key,moduleType:e.options?e.options.moduleType:void 0,moduleLocation:e.options?e.options.moduleLocation:void 0,pearApp:e.options&&"true"===e.options.pearApp?"true":"false",connectedStatus:t.toString()});this.trackLoadingEnded(e)};t.trackLoadingCancel=function(e){this._track("iframe.performance.cancel",{addonKey:e.addon_key,moduleKey:e.key,moduleType:e.options?e.options.moduleType:void 0,moduleLocation:e.options?e.options.moduleLocation:void 0,pearApp:e.options&&"true"===e.options.pearApp?"true":"false"})};t.trackUseOfDeprecatedMethod=function(e,t){this._track("jsapi.deprecated",{addonKey:t.addon_key,moduleKey:t.key,methodUsed:e})};t.trackMultipleDialogOpening=function(e,t){this._track("jsapi.dialog.multiple",{addonKey:t.addon_key,moduleKey:t.key,dialogType:e})};t.trackVisible=function(e){this._track("iframe.is_visible",{addonKey:e.addon_key,moduleKey:e.key,moduleType:e.options?e.options.moduleType:void 0,pearApp:e.options&&"true"===e.options.pearApp?"true":"false"})};t.trackIframePerformance=function(e,t){this._trackGasV3("operational",{source:t.addon_key,action:"iframeRendered",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:{key:t.key,pearApp:this._getPearApp(t),moduleType:this._getModuleType(t),iframeIsCacheable:this._isCacheable(t),moduleLocation:this._getModuleLocation(t),domainLookupTime:e.domainLookupTime,connectionTime:e.connectionTime,decodedBodySize:e.decodedBodySize,domContentLoadedTime:e.domContentLoadedTime,fetchTime:e.fetchTime}})};t.dispatch=function(e,t){this._track(e,t)};t.trackExternal=function(e,t){this._track(e,t)};t._resetAnalyticsDueToUnreliable=function(e){if(!e)throw new Error("Cannot reset analytics due to no extension id");if(this._addons[e]){clearTimeout(this._addons[e]);delete this._addons[e]}else console.info("Cannot clear analytics, cache does not contain extension id")};t._isCacheable=function(e){var t=e.url;return void 0!==t&&-1===t.indexOf("xdm_e=")};t._getModuleType=function(e){return e.options?e.options.moduleType:void 0};t._getModuleLocation=function(e){return e.options?e.options.moduleLocation:void 0};t._getPearApp=function(e){return e.options&&"true"===e.options.pearApp};t.trackGasV3Visible=function(e){this._trackGasV3("operational",{action:"iframeViewed",actionSubject:"connectAddon",actionSubjectId:e.addon_key,attributes:{moduleType:this._getModuleType(e),iframeIsCacheable:this._isCacheable(e),moduleKey:e.key,moduleLocation:this._getModuleLocation(e),pearApp:this._getPearApp(e)},source:e.addon_key})};t.trackGasV3LoadingEnded=function(e){var t=this._time()-this._addons[e.id].startLoading;this._trackGasV3("operational",{action:"iframeLoaded",actionSubject:"connectAddon",actionSubjectId:e.addon_key,attributes:{moduleType:this._getModuleType(e),iframeIsCacheable:this._isCacheable(e),iframeLoadMillis:t,moduleKey:e.key,moduleLocation:this._getModuleLocation(e),pearApp:this._getPearApp(e)},source:e.addon_key})};t.trackGasV3LoadingTimeout=function(e){this._trackGasV3("operational",{action:"iframeTimeout",actionSubject:"connectAddon",actionSubjectId:e.addon_key,attributes:{moduleType:this._getModuleType(e),iframeIsCacheable:this._isCacheable(e),moduleKey:e.key,moduleLocation:this._getModuleLocation(e),pearApp:this._getPearApp(e)},source:e.addon_key})};return e}(),b=new x;m.fn&&h.register("iframe-create",(function(e){b.trackLoadingStarted(e.extension)}));h.register("iframe-bridge-start",(function(e){b.trackLoadingStarted(e.extension)}));h.register("iframe-bridge-established",(function(e){b.trackLoadingEnded(e.extension);!function(e,t){if("function"==typeof t&&e instanceof Element){y.push({element:e,callback:t});p(e)}}(document.getElementById(e.extension.id),(function(){h.dispatch("iframe-visible",e.extension);b.trackVisible(e.extension);b.trackGasV3Visible(e.extension)}))}));h.register("iframe-bridge-established",(function(e){b.trackGasV3LoadingEnded(e.extension)}));h.register("iframe-bridge-timeout",(function(e){b.trackLoadingTimeout(e.extension)}));h.register("iframe-bridge-cancelled",(function(e){b.trackLoadingCancel(e.extension)}));h.register("analytics-deprecated-method-used",(function(e){b.trackUseOfDeprecatedMethod(e.methodUsed,e.extension)}));h.register("analytics-iframe-performance",(function(e){b.trackIframePerformance(e.metrics,e.extension)}));h.register("iframe-destroyed",(function(e){b._resetAnalyticsDueToUnreliable(e.extension.extension_id)}));h.register("analytics-external-event-track",(function(e){b.trackExternal(e.eventName,e.values)}));h.register("iframe-bridge-timeout",(function(e){b.trackGasV3LoadingTimeout(e.extension)}));var w=function(e,t){h.dispatch("iframe-bridge-timeout",{$el:e,extension:t})},k=function(e,t){h.dispatch("iframe-bridge-cancelled",{$el:e,extension:t})},E="ap-status-indicator",A='<div class="ap-loading"><div class="small-spinner"></div>Loading app...</div>',C='<div class="ap-load-timeout"><div class="small-spinner"></div>App is not responding. Wait or <a href="#" class="ap-btn-cancel">cancel</a>?</div>',I="App failed to load.",O=new(function(){function e(){this._stateRegistry={}}var t=e.prototype;t._loadingContainer=function(e){return e.find(".ap-status-indicator")};t.render=function(){var e=document.createElement("div");e.classList.add(E);e.innerHTML=A;var t=m(e);this._startSpinner(t);return t};t._startSpinner=function(e){setTimeout((function(){var t=e.find(".small-spinner");t.length&&t.spin&&t.spin({lines:12,length:3,width:2,radius:3,trail:60,speed:1.5,zIndex:1})}),10)};t.hide=function(e,t){this._clearTimeout(t);this._loadingContainer(e)[0].style.display="none"};t.cancelled=function(e,t){var n=I;this._loadingContainer(e).empty().text(n)};t._setupTimeout=function(e,t){this._stateRegistry[t.id]=setTimeout((function(){w(e,t)}),12e3)};t._clearTimeout=function(e){if(this._stateRegistry[e]){clearTimeout(this._stateRegistry[e]);delete this._stateRegistry[e]}};t.timeout=function(e,t){var n=m(C),i=this._loadingContainer(e);i.empty().append(n);this._startSpinner(i);m("a.ap-btn-cancel",i).click((function(){k(e,t)}));this._clearTimeout(t);return i};return e}());h.register("iframe-create",(function(e){e.extension.options.noDom||O._setupTimeout(e.$el.parents(".ap-iframe-container"),e.extension)}));h.register("iframe-bridge-established",(function(e){e.extension.options.noDom||O.hide(e.$el.parents(".ap-iframe-container"),e.extension.id)}));h.register("iframe-bridge-timeout",(function(e){e.extension.options.noDom||O.timeout(e.$el,e.extension.id)}));h.register("iframe-bridge-cancelled",(function(e){e.extension.options.noDom||O.cancelled(e.$el,e.extension.id)}));h.register("iframe-destroyed",(function(e){O._clearTimeout(e.extension.extension_id)}));var S=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++){n=r[i];t.indexOf(n)>=0||(o[n]=e[n])}return o};function T(e,t){P=T=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return T(e,t)}var P=T,M=P;function D(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return!0}catch(e){return!1}}function L(e,t,n){F=L=D()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));n&&M(o,n.prototype);return o};return L.apply(null,arguments)}var F=L,j=F,B="[Simple-XDM] ",N=Function.prototype.bind,$={locationOrigin:function(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")},randomString:function(){return Math.floor(1e9*Math.random()).toString(16)},isString:function(e){return"string"==typeof e||e instanceof String},argumentsToArray:function(e){return Array.prototype.slice.call(e)},argumentNames:function(e){return e.toString().replace(/((\/\/.*$)|(\/\*[^]*?\*\/))/gm,"").replace(/[^(]+\(([^)]*)[^]+/,"$1").match(/([^\s,]+)/g)||[]},hasCallback:function(e){var t=e.length;return t>0&&"function"==typeof e[t-1]},error:function(e){if(window.console&&window.console.error){var t=[];if("string"==typeof e){t.push(B+e);t=t.concat(Array.prototype.slice.call(arguments,1))}else{t.push(B);t=t.concat(Array.prototype.slice.call(arguments))}window.console.error.apply(null,t)}},warn:function(e){window.console&&console.warn(B+e)},log:function(e){window.console&&window.console.log(B+e)},_bind:function(e,t){return N&&t.bind===N?t.bind(e):function(){return t.apply(e,arguments)}},throttle:function(e,t,n){var i=0;return function(){var o=Date.now();if(o-i>t){i=o;e.apply(n,arguments)}}},each:function(e,t){var n,i;if(e)if(null!=(n=e.length)&&"function"!=typeof e){i=0;for(;i<n&&!1!==t.call(e[i],i,e[i]);)i+=1}else for(i in e)if(e.hasOwnProperty(i)&&!1===t.call(e[i],i,e[i]))break},extend:function(e){var t=arguments,n=[].slice.call(t,1,t.length);n.forEach((function(t){"object"==typeof t&&Object.getOwnPropertyNames(t).forEach((function(n){e[n]=t[n]}))}));return e},sanitizeStructuredClone:function(e){var t=[Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer],n=[Error,Node],i=$.warn,o=[];return function e(r){if("function"==typeof r){i("A function was detected and removed from the message.");return null}if(n.some((function(e){if(r instanceof e){i(e.name+" object was detected and removed from the message.");return!0}return!1})))return{};if(r&&"object"==typeof r&&t.every((function(e){return!(r instanceof e)}))){var a;if(Array.isArray(r))a=r.map((function(t){return e(t)}));else{if(o.indexOf(r)>-1){i("A circular reference was detected and removed from the message.");return null}o.push(r);a={};for(var s in r)if(r.hasOwnProperty(s)){var d=e(r[s]);null!==d&&(a[s]=d)}o.pop()}return a}return r}(e)},getOrigin:function(e,t){if("function"==typeof URL)try{return new URL(e,t).origin}catch(e){}var n=document.implementation.createHTMLDocument("");if(t){var i=n.createElement("base");i.href=t;n.head.appendChild(i)}var o=n.createElement("a");o.href=e;n.body.appendChild(o);var r=o.protocol+"//"+o.hostname;e.match(/\/\/[^/]+:[0-9]+\//)&&(r+=o.port?":"+o.port:"");return r}},J=function(t){e(i,t);var n=i.prototype;n._padUndefinedArguments=function(e,t){return e.length>=t?e:e.concat(new Array(t-e.length))};function i(e){var n;e=e||{};(n=t.call(this,e)||this)._registeredExtensions=e.extensions||{};n._registeredAPIModules={};n._registeredAPIModules._globals={};n._pendingCallbacks={};n._keycodeCallbacks={};n._clickHandler=null;n._pendingEvents={};n._messageHandlers={init:n._handleInit,req:n._handleRequest,resp:n._handleResponse,broadcast:n._handleBroadcast,event_query:n._handleEventQuery,key_triggered:n._handleKeyTriggered,addon_clicked:n._handleAddonClick,get_host_offset:n._getHostOffset,unload:n._handleUnload,sub:n._handleSubInit};return n}n._verifyAPI=function(e,t){var n=e.data.targets;if(n){var i=this.getApiSpec(),o=!1;!function e(t,n){Object.getOwnPropertyNames(n).forEach((function(i){"object"==typeof n[i]&&t[i]?e(t[i],n[i]):"parent"===n[i]&&t[i]&&(o=!0)}))}(i,n);e.source.postMessage({type:"api_tamper",tampered:o},t.extension.url)}};n._handleInit=function(e,t){e.source.postMessage({type:"init_received"},t.extension.url);this._registeredExtensions[t.extension_id].source=e.source;if(t.initCallback){t.initCallback(e.data.eid);delete t.initCallback}e.data.targets&&this._verifyAPI(e,t)};n._handleSubInit=function(e,t){var n=t.extension.options.noSub||this._getBooleanFeatureFlag&&this._getBooleanFeatureFlag("com.atlassian.connect.resolve_inner_iframe_url"),i=e.data;n?$.error("Sub-Extension requested by ["+t.extension.addon_key+"] but feature is disabled"):this.registerExtension(i.ext.id,{extension:i.ext});this._registeredRequestNotifier&&this._registeredRequestNotifier.call(null,{sub:i.ext,type:i.type,addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id,blocked:n})};n._getHostOffset=function(e,t){var n=e.source,i=null,o=t||window;o===o.top&&"function"==typeof o.getHostOffsetFunctionOverride&&(i=o.getHostOffsetFunctionOverride(n));if("number"!=typeof i){i=0;for(;!this._hasSameOrigin(n);){i++;n=n.parent}}e.source.postMessage({hostFrameOffset:i},e.origin)};n._hasSameOrigin=function(e){if(e===e.top)return!0;try{var t="test_var_"+Math.random().toString(16).substr(2);e[t]=!0;return e[t]}catch(e){}return!1};n._handleResponse=function(e){var t=e.data,n=this._pendingCallbacks[t.mid];if(n){delete this._pendingCallbacks[t.mid];n.apply(window,t.args)}};n.registerRequestNotifier=function(e){this._registeredRequestNotifier=e};n._handleRequest=function(e,t){function n(){var n=$.sanitizeStructuredClone($.argumentsToArray(arguments));e.source.postMessage({mid:e.data.mid,type:"resp",forPlugin:!0,args:n},t.extension.url)}var i=e.data,o=this._registeredAPIModules[i.mod],r=this.getRegisteredExtensions(t.extension)[0];if(o){var a=i.fn;if(i._cls){var s=o[i._cls],d=i.mod+"-"+i._cls+"-";n._id=i._id;if("constructor"===a){if(!s._construct){s.constructor.prototype._destroy=function(){delete this._context._proxies[d+this._id]};s._construct=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=j(s.constructor,t),o=t[t.length-1];i._id=o._id;i._context=o._context;i._context._proxies[d+i._id]=i;return i}}o=s;a="_construct"}else o=r._proxies[d+i._id]}var c=o[a];if(c){var l=i.args,u=c.length-1;"_construct"===a&&(u=o.constructor.length-1);n._context=r;(l=this._padUndefinedArguments(l,u)).push(n);var f=c.apply(o,l);c.returnsPromise&&("object"!=typeof f&&"function"!=typeof f||"function"!=typeof f.then?n("Defined module method did not return a promise."):f.then((function(e){n(void 0,e)})).catch((function(e){n(e=e instanceof Error?e.message:e)})));this._registeredRequestNotifier&&this._registeredRequestNotifier.call(null,{module:i.mod,fn:i.fn,type:i.type,addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id})}}};n._handleBroadcast=function(e,t){var n=e.data;this.dispatch(n.etyp,(function(e){return e.extension.addon_key===t.extension.addon_key&&e.extension_id!==t.extension_id}),n.evnt,null,null)};n._handleKeyTriggered=function(e,t){var n=e.data,i=this._keycodeKey(n.keycode,n.modifiers,t.extension_id),o=this._keycodeCallbacks[i];o&&o.forEach((function(e){e.call(null,{addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id,keycode:n.keycode,modifiers:n.modifiers})}),this)};n.defineAPIModule=function(e,t){t=t||"_globals";this._registeredAPIModules[t]=$.extend({},this._registeredAPIModules[t]||{},e);return this._registeredAPIModules};n.isAPIModuleDefined=function(e){return void 0!==this._registeredAPIModules[e]};n._pendingEventKey=function(e,t){var n=e.addon_key||"global";e.key&&(n=n+"@@"+e.key);return n=n+"@@"+t};n.queueEvent=function(e,t,n,i){if(this._findRegistrations(t).some((function(e){return void 0!==e.registered_events}),this))this.dispatch(e,t,n,i);else{this._cleanupInvalidEvents();var o=(new Date).getTime();this._pendingEvents[this._pendingEventKey(t,o)]={type:e,targetSpec:t,event:n,callback:i,time:o,uid:$.randomString()}}};n._cleanupInvalidEvents=function(){var e=this,t=(new Date).getTime();Object.keys(this._pendingEvents).forEach((function(n){var i=e._pendingEvents[n];t-i.time<=3e4||delete e._pendingEvents[n]}))};n._handleEventQuery=function(e,t){var n=this,i={},o=(new Date).getTime();Object.keys(this._pendingEvents).forEach((function(r){var a=n._pendingEvents[r],s=o-a.time<=3e4,d=!a.targetSpec||0!==n._findRegistrations(a.targetSpec).length;d&&a.targetSpec.key&&(d=a.targetSpec.addon_key===t.extension.addon_key&&a.targetSpec.key===t.extension.key);if(s&&d){i[r]=a;a.targetSpec=a.targetSpec||{};n.dispatch(a.type,a.targetSpec,a.event,a.callback,e.source)}else s||delete n._pendingEvents[r]}));this._registeredExtensions[t.extension_id].registered_events=e.data.args;return i};n._handleUnload=function(e,t){if(t){t.extension_id&&this._registeredExtensions[t.extension_id]&&delete this._registeredExtensions[t.extension_id].source;t.unloadCallback&&t.unloadCallback(e.data.eid)}};n.dispatch=function(e,t,n,i,o){function r(t,n){if(t.source&&t.source.postMessage){var o;if(i){o=$.randomString();this._pendingCallbacks[o]=i}t.source.postMessage({type:"evt",mid:o,etyp:e,evnt:n},t.extension.url)}}this._findRegistrations(t||{}).forEach((function(e){o&&!e.source&&(e.source=o);e.source&&$._bind(this,r)(e,n)}),this)};n._findRegistrations=function(e){var t=this;if(0===this._registeredExtensions.length){$.error("no registered extensions",this._registeredExtensions);return[]}var n=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(this._registeredExtensions).map((function(e){return t._registeredExtensions[e]}));return e instanceof Function?i.filter(e):i.filter((function(t){return n.every((function(n){return t.extension[n]===e[n]}))}))};n.registerExtension=function(e,t){t._proxies={};t.extension_id=e;this._registeredExtensions[e]=t};n._keycodeKey=function(e,t,n){var i=e;if(t){"string"==typeof t&&(t=[t]);t.sort();t.forEach((function(e){i+="$$"+e}),this)}return i+"__"+n};n.registerKeyListener=function(e,t,n,i){"string"==typeof n&&(n=[n]);var o=this._registeredExtensions[e],r=this._keycodeKey(t,n,e);if(!this._keycodeCallbacks[r]){this._keycodeCallbacks[r]=[];o.source.postMessage({type:"key_listen",keycode:t,modifiers:n,action:"add"},o.extension.url)}this._keycodeCallbacks[r].push(i)};n.unregisterKeyListener=function(e,t,n,i){var o=this._keycodeKey(t,n,e),r=this._keycodeCallbacks[o],a=this._registeredExtensions[e];if(r){if(i){var s=r.indexOf(i);this._keycodeCallbacks[o].splice(s,1)}else delete this._keycodeCallbacks[o];a.source&&a.source.postMessage&&a.source.postMessage({type:"key_listen",keycode:t,modifiers:n,action:"remove"},a.extension.url)}};n.registerClickHandler=function(e){if("function"!=typeof e)throw new Error("callback must be a function");if(null!==this._clickHandler)throw new Error("ClickHandler already registered");this._clickHandler=e};n._handleAddonClick=function(e,t){"function"==typeof this._clickHandler&&this._clickHandler({addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id})};n.unregisterClickHandler=function(){this._clickHandler=null};n.getApiSpec=function(e){var t=this;function n(e){return Object.getOwnPropertyNames(e).reduce((function(t,i){var o=e[i];switch(typeof o){case"function":t[i]={args:$.argumentNames(o),returnsPromise:o.returnsPromise||!1};break;case"object":o.hasOwnProperty("constructor")&&(t[i]=n(o))}return t}),{})}return Object.getOwnPropertyNames(this._registeredAPIModules).reduce((function(i,o){var r=t._registeredAPIModules[o];void 0!==r.addonKey&&r.addonKey!==e||(i[o]=n(r));return i}),{})};n._originEqual=function(e,t){function n(e){return"string"==typeof e&&e.length>0}var i=$.getOrigin(e);return!!(n(e)&&n(t)&&n(i))&&t===i};n._checkOrigin=function(e,t){var n=t&&!t.source&&["init"].indexOf(e.data.type)>-1,i=t&&e.source===t.source,o=t&&this._originEqual(t.extension.url,e.origin)&&(n||i);"get_host_offset"===e.data.type&&window===window.top&&(o=!0);"unload"!==e.data.type||!i&&void 0!==e.source||(o=!0);return o};n.getRegisteredExtensions=function(e){return e?this._findRegistrations(e):this._registeredExtensions};n.unregisterExtension=function(e){var t=this._findRegistrations(e);0!==t.length&&t.forEach((function(e){var t=this;Object.keys(this._pendingEvents).forEach((function(n){var i=t._pendingEvents[n].targetSpec||{};i.addon_key===e.extension.addon_key&&i.key===e.extension.key&&delete t._pendingEvents[n]}));delete this._registeredExtensions[e.extension_id]}),this)};n.setFeatureFlagGetter=function(e){this._getBooleanFeatureFlag=e};return i}(function(){function e(e){var t=e||{};this._registerListener(t.listenOn)}var t=e.prototype;t._registerListener=function(e){e&&e.addEventListener||(e=window);e.addEventListener("message",$._bind(this,this._receiveMessage),!1)};t._receiveMessage=function(e){var t,n=this._messageHandlers[e.data.type],i=e.data.eid;i&&this._registeredExtensions&&(t=this._registeredExtensions[i]);if(!n||!this._checkOrigin(e,t))return!1;n.call(this,e,t)};return e}()),R=function(){function e(){this._xdm=new J}var t=e.prototype;t.dispatch=function(e,t,n,i){this._xdm.queueEvent(e,t,n,i);return this.getExtensions(t)};t.broadcast=function(e,t,n){this._xdm.dispatch(e,t,n,null,null);return this.getExtensions(t)};t._createId=function(e){if(!e.addon_key||!e.key)throw Error("Extensions require addon_key and key");return e.addon_key+"__"+e.key+"__"+$.randomString()};t.create=function(e,t,n){var i=this.registerExtension(e,t,n),o=e.options||{},r={extension_id:i,api:this._xdm.getApiSpec(e.addon_key),origin:$.locationOrigin(),options:o};return{id:i,name:JSON.stringify(r),src:e.url}};t.registerRequestNotifier=function(e){this._xdm.registerRequestNotifier(e)};t.registerExtension=function(e,t,n){var i=this._createId(e);this._xdm.registerExtension(i,{extension:e,initCallback:t,unloadCallback:n});return i};t.registerKeyListener=function(e,t,n,i){this._xdm.registerKeyListener(e,t,n,i)};t.unregisterKeyListener=function(e,t,n,i){this._xdm.unregisterKeyListener(e,t,n,i)};t.registerClickHandler=function(e){this._xdm.registerClickHandler(e)};t.unregisterClickHandler=function(){this._xdm.unregisterClickHandler()};t.defineModule=function(e,t,n){this._xdm.defineAPIModule(t,e,n)};t.isModuleDefined=function(e){return this._xdm.isAPIModuleDefined(e)};t.defineGlobals=function(e){this._xdm.defineAPIModule(e)};t.getExtensions=function(e){return this._xdm.getRegisteredExtensions(e)};t.unregisterExtension=function(e){return this._xdm.unregisterExtension(e)};t.returnsPromise=function(e){e.returnsPromise=!0};t.setFeatureFlagGetter=function(e){this._xdm.setFeatureFlagGetter(e)};t.registerExistingExtension=function(e,t){return this._xdm.registerExtension(e,t)};return e}(),z=new R,H=function(e,t,n){z.dispatch(e,t,n);h.dispatch("event-dispatch",{type:e,targetSpec:t,event:n})},K=function(e,t,n){h.dispatch("event-public-dispatch",{type:e,event:t,sender:n});var i=n.options||{};i.contextJwt;i.url;var o=S(i,["contextJwt","url"]);z.dispatch(e,{},{sender:{addonKey:n.addon_key,key:n.key,options:$.sanitizeStructuredClone(o)},event:t})};function U(e){if(!e)throw new Error("No selector to escape");return e.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")}var q={escapeSelector:U,stringToDimension:function(e){var t=!1,n="px";if("string"==typeof e){t=e.indexOf("%")===e.length-1;e=parseInt(e,10);t&&(n="%")}if(!isNaN(e))return e+n},getIframeByExtensionId:function(e){return m("iframe#"+U(e))},first:function(e,t){return t?e.slice(0,t):e[0]},last:function(e){return e[e.length-1]},pick:function(e,t){return"object"!=typeof e?{}:Object.keys(e).filter((function(e){return t.indexOf(e)>=0})).reduce((function(t,n){var i;return Object.assign(t,((i={})[n]=e[n],i))}),{})},debounce:function(e,t){var n;return function(){var i=this,o=[].slice.call(arguments);function r(){n=null;e.apply(i,o)}n&&clearTimeout(n);n=setTimeout(r,t||50)}},isSupported:function(e,t,n,i){return e&&e[t]&&e[t].supports?e[t].supports(n):i},extend:Object.assign},V={emit:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var o=q.last(n);n=q.first(n,-1);H(e,{addon_key:o._context.extension.addon_key},n)},emitPublic:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var o=q.last(n),r=o._context.extension;n=q.first(n,-1);K(e,n,r)},emitToDataProvider:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=q.last(t);i._context.extension;t=q.first(t,-1);H("dataProviderEvent",{addon_key:i._context.extension.addon_key},t)}},W=function(e,t){h.dispatch("dialog-extension-open",{extension:e,options:t})},G=function(){h.dispatch("dialog-close-active",{})},X=function(e,t){h.dispatch("dialog-button-add",{button:{text:e.text,identifier:e.identifier,data:{userButton:!0}},extension:t})},Y={close:function(e){h.dispatch("dialog-close",{dialog:e.dialog,extension:e.extension,customData:e.customData})},closeActive:function(e){h.dispatch("dialog-close-active",e)},clickButton:function(e,t,n){h.dispatch("dialog-button-click",{identifier:e,$el:t,extension:n})},toggleButton:function(e){h.dispatch("dialog-button-toggle",e)},toggleButtonVisibility:function(e){h.dispatch("dialog-button-toggle-visibility",e)}},Q=function(e){z.registerKeyListener(e.extension_id,e.key,e.modifiers,e.callback);h.dispatch("dom-event-register",e)},Z=function(e){z.unregisterKeyListener(e.extension_id,e.key,e.modifiers,e.callback);h.dispatch("dom-event-unregister",e)},ee=function(e){window.addEventListener("keydown",(function(t){t.keyCode===e.keyCode&&e.callback()}))},te=function(e){z.registerClickHandler((function(t){var n=document.getElementById(t.extension_id);n&&e(n)}))},ne=function(){z.unregisterClickHandler()},ie=new(function(){function e(){}e.prototype.randomIdentifier=function(){return Math.random().toString(16).substring(7)};return e}()),oe=new(function(){function e(){}var t=e.prototype;t._maxDimension=function(e,t){var n=q.stringToDimension(e),i=parseInt(n,10),o=parseInt(t,10);return n.indexOf("%")>-1&&i>=100||i>o?"100%":n};t._closeOnEscape=function(e){return!1!==e.closeOnEscape};t._size=function(e){var t=e.size;"x-large"===e.size&&(t="xlarge");"maximum"!==e.size&&"100%"===e.width&&"100%"===e.height&&(t="fullscreen");return t};t._header=function(e){var t="";switch(typeof e){case"string":t=e;break;case"object":t=e.value}return t};t._hint=function(e){return"string"==typeof e?e:""};t._chrome=function(e){var t=!1;"boolean"==typeof e.chrome&&(t=e.chrome);"fullscreen"===e.size&&(t=!0);"maximum"===e.size&&(t=!1);return t};t._width=function(e){if(!e.size)return e.width?this._maxDimension(e.width,m(window).width()):"50%"};t._height=function(e){if(!e.size)return e.height?this._maxDimension(e.height,m(window).height()):"50%"};t._actions=function(e){var t=[];(e=e||{}).actions||(t=[{name:"submit",identifier:"submit",text:e.submitText||"Submit",type:"primary",disabled:!0},{name:"cancel",identifier:"cancel",text:e.cancelText||"Cancel",type:"link",immutable:!0}]);e.buttons&&(t=t.concat(this._buttons(e)));return t};t._id=function(e){"string"!=typeof e&&(e=Math.random().toString(36).substring(2,8));return e};t._buttons=function(e){var t=[];e.buttons&&Array.isArray(e.buttons)&&e.buttons.forEach((function(e){var n,i,o=!1;e.text&&"string"==typeof e.text&&(n=e.text);i=e.identifier&&"string"==typeof e.identifier?e.identifier:ie.randomIdentifier();e.disabled&&!0===e.disabled&&(o=!0);t.push({text:n,identifier:i,type:"secondary",custom:!0,disabled:o})}));return t};t._onHide=function(e){return"function"==typeof e.onHide?e.onHide:function(){}};t.sanitizeOptions=function(e){e=e||{};var t={chrome:this._chrome(e),header:this._header(e.header),hint:this._hint(e.hint),width:this._width(e),height:this._height(e),$content:e.$content,extension:e.extension,actions:this._actions(e),id:this._id(e.id),size:e.size,closeOnEscape:this._closeOnEscape(e),onHide:this._onHide(e)};t.size=this._size(t);return t};t.moduleOptionsFromGlobal=function(e,t){return!!(window._AP&&window._AP.dialogModules&&window._AP.dialogModules[e]&&window._AP.dialogModules[e][t])&&q.extend({},{chrome:!0},window._AP.dialogModules[e][t].options)};t.trackMultipleDialogOpening=function(e,t){var n,i=this._size(t);if(m(".ap-aui-dialog2:visible").length){n=m("#macro-browser-dialog").length||AJS.Confluence&&AJS.Confluence.Editor&&AJS.Confluence.Editor.currentEditMode?"fullscreen"===i?"connect-macro-multiple-fullscreen":"connect-macro-multiple":"connect-multiple";b.trackMultipleDialogOpening(n,e)}};t.assertActiveDialogOrThrow=function(e,t){if(!e.isActiveDialog(t))throw new Error("Failed to find an active dialog for: "+t)};return e}()),re={notifyIframeCreated:function(e,t){h.dispatch("iframe-create",{$el:e,extension:t})},notifyBridgeEstablished:function(e,t){h.dispatch("iframe-bridge-established",{$el:e,extension:t})},notifyIframeDestroyed:function(e){"string"==typeof e&&(e={id:e});z.getExtensions(e).forEach((function(e){h.dispatch("iframe-destroyed",{extension:e});z.unregisterExtension({id:e.extension_id})}),this)},notifyUnloaded:function(e,t){h.dispatch("iframe-unload",{$el:e,extension:t})}},ae={},se=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))},de="%[a-f0-9]{2}",ce=new RegExp(de,"gi"),le=new RegExp("("+de+")+","gi");function ue(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],ue(n),ue(i))}function fe(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(ce),n=1;n<t.length;n++)t=(e=ue(t,n).join("")).match(ce);return e}}var pe=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{e=e.replace(/\+/g," ");return decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=le.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var i=fe(n[0]);i!==n[0]&&(t[n[0]]=i)}n=le.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),r=0;r<o.length;r++){var a=o[r];e=e.replace(new RegExp(a,"g"),t[a])}return e}(e)}},ge=function(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];var n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]},he=function(e,t){for(var n={},i=Object.keys(e),o=Array.isArray(t),r=0;r<i.length;r++){var a=i[r],s=e[a];(o?-1!==t.indexOf(a):t(a,s,e))&&(n[a]=s)}return n};!function(e){const t=se,n=pe,i=ge,o=he,r=Symbol("encodeFragmentIdentifier");function a(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function s(e,n){return n.encode?n.strict?t(e):encodeURIComponent(e):e}function d(e,t){return t.decode?n(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function l(e){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t));return e}function u(e){const t=(e=l(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function f(e,t){t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase());return e}function p(e,t){a((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e);e=e.replace(/\[\d*\]$/,"");if(t){void 0===i[e]&&(i[e]={});i[e][t[1]]=n}else i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e);e=e.replace(/\[\]$/,"");t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const o="string"==typeof n&&n.includes(e.arrayFormatSeparator),r="string"==typeof n&&!o&&d(n,e).includes(e.arrayFormatSeparator);n=r?d(n,e):n;const a=o||r?n.split(e.arrayFormatSeparator).map((t=>d(t,e))):null===n?n:d(n,e);i[t]=a};case"bracket-separator":return(t,n,i)=>{const o=/(\[\])$/.test(t);t=t.replace(/\[\]$/,"");if(!o){i[t]=n?d(n,e):n;return}const r=null===n?[]:n.split(e.arrayFormatSeparator).map((t=>d(t,e)));void 0!==i[t]?i[t]=[].concat(i[t],r):i[t]=r};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),o=Object.create(null);if("string"!=typeof e)return o;if(!(e=e.trim().replace(/^[?#&]/,"")))return o;for(const r of e.split("&")){if(""===r)continue;let[e,a]=i(t.decode?r.replace(/\+/g," "):r,"=");a=void 0===a?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?a:d(a,t);n(d(e,t),a,o)}for(const e of Object.keys(o)){const n=o[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=f(n[e],t);else o[e]=f(n,t)}return!1===t.sort?o:(!0===t.sort?Object.keys(o).sort():Object.keys(o).sort(t.sort)).reduce(((e,t)=>{const n=o[t];Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=c(n):e[t]=n;return e}),Object.create(null))}e.extract=u;e.parse=p;e.stringify=(e,t)=>{if(!e)return"";a((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],i=function(e){switch(e.arrayFormat){case"index":return t=>(n,i)=>{const o=n.length;return void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[s(t,e),"[",o,"]"].join("")]:[...n,[s(t,e),"[",s(o,e),"]=",s(i,e)].join("")]};case"bracket":return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[s(t,e),"[]"].join("")]:[...n,[s(t,e),"[]=",s(i,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return n=>(i,o)=>{if(void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o)return i;o=null===o?"":o;return 0===i.length?[[s(n,e),t,s(o,e)].join("")]:[[i,s(o,e)].join(e.arrayFormatSeparator)]}}default:return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,s(t,e)]:[...n,[s(t,e),"=",s(i,e)].join("")]}}(t),o={};for(const t of Object.keys(e))n(t)||(o[t]=e[t]);const r=Object.keys(o);!1!==t.sort&&r.sort(t.sort);return r.map((n=>{const o=e[n];return void 0===o?"":null===o?s(n,t):Array.isArray(o)?0===o.length&&"bracket-separator"===t.arrayFormat?s(n,t)+"[]":o.reduce(i(n),[]).join("&"):s(n,t)+"="+s(o,t)})).filter((e=>e.length>0)).join("&")};e.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,o]=i(e,"#");return Object.assign({url:n.split("?")[0]||"",query:p(u(e),t)},t&&t.parseFragmentIdentifier&&o?{fragmentIdentifier:d(o,t)}:{})};e.stringifyUrl=(t,n)=>{n=Object.assign({encode:!0,strict:!0,[r]:!0},n);const i=l(t.url).split("?")[0]||"",o=e.extract(t.url),a=e.parse(o,{sort:!1}),d=Object.assign(a,t.query);let c=e.stringify(d,n);c&&(c=`?${c}`);let u=function(e){let t="";const n=e.indexOf("#");-1!==n&&(t=e.slice(n));return t}(t.url);t.fragmentIdentifier&&(u=`#${n[r]?s(t.fragmentIdentifier,n):t.fragmentIdentifier}`);return`${i}${c}${u}`};e.pick=(t,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0,[r]:!1},i);const{url:a,query:s,fragmentIdentifier:d}=e.parseUrl(t,i);return e.stringifyUrl({url:a,query:o(s,n),fragmentIdentifier:d},i)};e.exclude=(t,n,i)=>{const o=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return e.pick(t,o,i)}}(ae);for(var me=function(e){for(var t,n=function(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);return[n,n===t?0:4-n%4]}(e),i=n[0],o=n[1],r=new _e(function(e,t,n){return 3*(t+n)/4-n}(0,i,o)),a=0,s=o>0?i-4:i,d=0;d<s;d+=4){t=ve[e.charCodeAt(d)]<<18|ve[e.charCodeAt(d+1)]<<12|ve[e.charCodeAt(d+2)]<<6|ve[e.charCodeAt(d+3)];r[a++]=t>>16&255;r[a++]=t>>8&255;r[a++]=255&t}if(2===o){t=ve[e.charCodeAt(d)]<<2|ve[e.charCodeAt(d+1)]>>4;r[a++]=255&t}if(1===o){t=ve[e.charCodeAt(d)]<<10|ve[e.charCodeAt(d+1)]<<4|ve[e.charCodeAt(d+2)]>>2;r[a++]=t>>8&255;r[a++]=255&t}return r},ye=[],ve=[],_e="undefined"!=typeof Uint8Array?Uint8Array:Array,xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",be=0,we=xe.length;be<we;++be){ye[be]=xe[be];ve[xe.charCodeAt(be)]=be}ve["-".charCodeAt(0)]=62;ve["_".charCodeAt(0)]=63;function ke(e){var t=4-e.length%4;1===t?e+="=":2===t&&(e+="==");return(new TextDecoder).decode(me(e))}var Ee=60;function Ae(e){if(null===e||""===e)throw"Invalid JWT: must be neither null nor empty-string.";var t=e.indexOf("."),n=e.indexOf(".",t+1);if(t<0||n<=t)throw'Invalid JWT: must contain 2 period (".") characters.';var i=e.substring(t+1,n);if(null===i||""===i)throw"Invalid JWT: encoded claims must be neither null nor empty-string.";var o=ke.call(window,i);return JSON.parse(o)}h.register("jwt-skew-set",(function(e){Ee=e.skew}));var Ce={parseJwtIssuer:function(e){return Ae(e).iss},parseJwtClaims:Ae,isJwtExpired:function(e,t){void 0===t&&(t=Ee);var n=Ae(e),i=0,o=Math.floor(Date.now()/1e3);n&&n.exp&&(i=n.exp);return i-t<o}};function Ie(e){return ae.parse(ae.extract(e)).jwt}var Oe={hasJwt:function(e){return Ie(e)&&0!==Ie(e).length},isJwtExpired:function(e){var t=Ie(e);return Ce.isJwtExpired(t)}},Se=function(e){h.dispatch("content-resolver-register-by-extension",e)},Te=function(e){if(!e.resolver)throw Error("ACJS: No content resolver supplied");var t=e.resolver.call(null,q.extend({classifier:"json"},e.extension));t.fail((function(t,n){h.dispatch("jwt-url-refreshed-failed",{extension:e.extension,$container:e.$container,errorText:n.text})}));t.done((function(t){var n={};if("object"==typeof t)n=t;else if("string"==typeof t)try{n=JSON.parse(t)}catch(e){console.error("ACJS: invalid response from content resolver")}e.extension.url=n.url;q.extend(e.extension.options,n.options);h.dispatch("jwt-url-refreshed",{extension:e.extension,$container:e.$container,url:e.extension.url})}));h.dispatch("jwt-url-refresh-request",{data:e})},Pe=function(e){"number"==typeof e?h.dispatch("jwt-skew-set",{skew:e}):console.error("ACJS: invalid JWT clock skew set")},Me=function(e){var t={};if(e&&"object"==typeof e){e.width&&(t.width=q.stringToDimension(e.width));e.height&&(t.height=q.stringToDimension(e.height));if("string"==typeof e.sandbox){var n=document.createElement("iframe");t.sandbox=e.sandbox.split(" ").filter((function(e){return q.isSupported(n,"sandbox",e,!0)})).join(" ")}}return t},De=new(function(){function e(){this.store={}}var t=e.prototype;t.set=function(e,t){if(t){var n={};n[e]=t}else n=e;q.extend(this.store,n)};t.get=function(e){return e?this.store[e]:q.extend({},this.store)};return e}()),Le=!1,Fe="com.codebarrel.addons.automation";var je=!1;function Be(e){return{addon_key:e.addon_key,key:e.key,url:e.url,options:e.options}}var Ne={createSimpleXdmExtension:function(e){var t=Be(e),n=De.get();e.options=t.options=q.extend({},t.options);e.options.globalOptions=n;!function(e){_("com.atlassian.connect.acjs-oc-1657-add-performance-timing-api")&&e===Fe&&function(){if(!Le){Le=!0;var e={getPerformanceTiming:function(e){return new Promise((function(n,i){t(e)||i(new Error("This is a restricted API"));n(JSON.parse(JSON.stringify(window.performance.timing)))}))},getPerformanceNavigationTiming:function(e){return new Promise((function(n,i){t(e)||i(new Error("This is a restricted API"));window.PerformanceNavigationTiming||n(void 0);var o=window.performance.getEntriesByType("navigation");n(JSON.parse(JSON.stringify(o)))}))}};z.returnsPromise(e.getPerformanceTiming);z.returnsPromise(e.getPerformanceNavigationTiming);z.defineModule("_performance",e)}function t(e){return e._context.extension.addon_key===Fe}}();_("com.atlassian.connect.acjs.oc-1890-enable-iframe-feature-flags")&&function(){if(!je){je=!0;var e={getBooleanFeatureFlag:function(e){return new Promise((function(t,n){0===e.indexOf("com.atlassian.connect.acjs.iframe.")?t(_(e)):n(new Error("Only allowlisted flags can be accessed from the iframe."))}))}};z.returnsPromise(e.getBooleanFeatureFlag);z.defineModule("_featureFlag",e)}}()}(e.addon_key);var i=z.create(t,(function(){e.options.noDOM||(e.$el=m(document.getElementById(e.id)));re.notifyBridgeEstablished(e.$el,e)}),(function(){re.notifyUnloaded(e.$el,e)}));t.id=i.id;e.id=i.id;q.extend(i,Me(e.options));return{iframeAttributes:i,extension:e}},extensionConfigSanitizer:Be},$e=new(function(){function e(){this._contentResolver=!1}var t=e.prototype;t.setContentResolver=function(e){this._contentResolver=e};t.resize=function(e,t,n){e=q.stringToDimension(e);t=q.stringToDimension(t);n.css({width:e,height:t});n.trigger("resized",{width:e,height:t})};t.simpleXdmExtension=function(e,t){!e.url||Oe.hasJwt(e.url)&&Oe.isJwtExpired(e.url)?this._contentResolver?Te({extension:e,resolver:this._contentResolver,$container:t}):console.error("JWT is expired and no content resolver was specified"):this._appendExtension(t,this._simpleXdmCreate(e))};t._simpleXdmCreate=function(e){var t=Ne.createSimpleXdmExtension(e);e.id=t.iframeAttributes.id;e.$el=this.render(t.iframeAttributes);return e};t._appendExtension=function(e,t){var n=e.find("iframe");n.length>0&&n.destroy();t.options.hideIframeUntilLoad&&t.$el.css({visibility:"hidden"}).load((function(){t.$el.css({visibility:""})}));e.prepend(t.$el);re.notifyIframeCreated(t.$el,t)};t._appendExtensionError=function(e,t){var n=m('<div class="connect-resolve-error"></div>'),i=m("<p />").text(t);n.append('<p class="error">Error: The content resolver threw the following error:</p>');n.append(i);e.prepend(n)};t.resolverResponse=function(e){var t=this._simpleXdmCreate(e.extension);this._appendExtension(e.$container,t)};t.resolverFailResponse=function(e){this._appendExtensionError(e.$container,e.errorText)};t.render=function(e){(e=e||{}).referrerpolicy="no-referrer";return m("<iframe />").attr(e).addClass("ap-iframe")};return e}());h.register("iframe-resize",(function(e){$e.resize(e.width,e.height,e.$el)}));h.register("content-resolver-register-by-extension",(function(e){$e.setContentResolver(e.callback)}));h.register("jwt-url-refreshed",(function(e){$e.resolverResponse(e)}));h.register("jwt-url-refreshed-failed",(function(e){$e.resolverFailResponse(e)}));h.register("after:iframe-bridge-established",(function(e){e.extension.options.noDom?e.extension.options.bridgeEstablished=!0:e.$el[0].bridgeEstablished=!0}));var Je=function(e){h.dispatch("button-clicked",{$el:e})},Re=function(e,t){h.dispatch("button-toggle",{$el:e,disabled:t})},ze=function(e,t){h.dispatch("button-toggle-visibility",{$el:e,hidden:t})},He=["primary","link","secondary"],Ke=0,Ue=function(){function e(){this.AP_BUTTON_CLASS="ap-aui-button"}var t=e.prototype;t.setType=function(e,t){t&&He.indexOf(t)>=0&&e.addClass("aui-button-"+t);return e};t.setDisabled=function(e,t){void 0===t||e.data("immutable")||e.attr("aria-disabled",t);return e};t.setHidden=function(e,t){void 0===t||e.data("immutable")||e.toggle(!t);return e};t._setId=function(e,t){if(!t){t="ap-button-"+Ke;Ke++}e.attr("id",t);return e};t._additionalClasses=function(e,t){if(t){"string"!=typeof t&&(t=t.join(" "));e.addClass(t)}return e};t.getName=function(e){return m(e).data("name")};t.getText=function(e){return m(e).text()};t.getIdentifier=function(e){return m(e).data("identifier")};t.isVisible=function(e){return m(e).is(":visible")};t.isEnabled=function(e){return!("true"===m(e).attr("aria-disabled"))};t.render=function(e){var t=m("<button />");e=e||{};t.addClass("aui-button "+this.AP_BUTTON_CLASS);t.text(e.text);t.data(e.data);t.data({name:e.name||e.identifier,identifier:e.identifier||ie.randomIdentifier(),immutable:e.immutable||!1});this._additionalClasses(t,e.additionalClasses);this.setType(t,e.type);this.setDisabled(t,e.disabled||!1);this._setId(t,e.id);return t};return e}(),qe=new Ue;m((function(){m("body").on("click","."+qe.AP_BUTTON_CLASS,(function(e){var t=m(e.target).closest("."+qe.AP_BUTTON_CLASS);"true"!==t.attr("aria-disabled")&&Je(t)}))}));h.register("button-toggle",(function(e){qe.setDisabled(e.$el,e.disabled)}));h.register("button-toggle-visibility",(function(e){qe.setHidden(e.$el,e.hidden)}));var Ve=["ap-iframe-container"],We=new(function(){function e(){}var t=e.prototype;t.createExtension=function(e,t){var n=this._renderContainer();t&&!1===t.loadingIndicator||n.append(this._renderLoadingIndicator());$e.simpleXdmExtension(e,n);return n};t._renderContainer=function(e){var t=m("<div />").attr(e||{});t.addClass(Ve.join(" "));return t};t._renderLoadingIndicator=function(){return O.render()};return e}());h.register("iframe-create",(function(e){var t="embedded-"+e.extension.id;e.extension.$el.parents(".ap-iframe-container").attr("id",t)}));function Ge(e){return We.createExtension(e)}var Xe=function(e,t){var n={};if(t){n.methods=t;n.name=e}else n.methods=e;h.dispatch("module-define-custom",n)},Ye=function(e,t){h.dispatch("analytics-deprecated-method-used",{methodUsed:e,extension:t})},Qe=function(e){h.dispatch("iframe-bridge-start",{extension:e})},Ze=function(e,t){h.dispatch("analytics-external-event-track",{eventName:e,values:t})},et=function(e,t){e&&Object.getOwnPropertyNames(e).length>0&&h.dispatch("analytics-iframe-performance",{metrics:e,extension:t})};function tt(e){var t=e.attr("class"),n=t?t.match(/ap-plugin-key-([^\s]*)/):null;return!!Array.isArray(n)&&n[1]}function nt(e){var t=e.attr("class"),n=t?t.match(/ap-module-key-([^\s]*)/):null;return!!Array.isArray(n)&&n[1]}function it(e){return tt(e)+"__"+nt(e)}function ot(e,t,n){var i=e+"Modules";if(window._AP&&window._AP[i]&&window._AP[i][t]&&window._AP[i][t][n])return q.extend({},window._AP[i][t][n].options)}function rt(e,t){var n=tt(t),i=function(e){var t=e.attr("class"),n=t?t.match(/ap-target-key-([^\s]*)/):null;return!!Array.isArray(n)&&n[1]}(t);return ot(e,n,i)}function at(e){var t,n=e.attr("href"),i={};n||(n=e.find("a").attr("href"));if(n){var o=n.indexOf("#");if(o>=0){var r=n.substring(o+1);try{t=JSON.parse(decodeURI(r))}catch(e){console.error("ACJS: cannot decode webitem anchor")}t&&window._AP&&window._AP._convertConnectOptions?i=window._AP._convertConnectOptions(t):console.error("ACJS: cannot convert webitem url to connect iframe options")}else{var a=it(e),s=e.hasClass("ap-inline-dialog")?"inlineDialog":"dialog",d=rt(s,e);!d&&window._AP&&window._AP[s+"Options"]&&(d=q.extend({},window._AP[s+"Options"][a])||{});if(!d){d={};console.warn("no webitem "+s+"Options for "+a)}d.productContext=d.productContext||{};var c=ae.parse(ae.extract(n));q.extend(d.productContext,c);i={addon_key:tt(e),key:nt(e),options:d}}}return i}var st={sanitizeTriggers:function(e){var t;Array.isArray(e)?t=e.join(" "):"string"==typeof e&&(t=e.trim());return t},uniqueId:function(){return"webitem-"+Math.floor(1e9*Math.random()).toString(16)},getExtensionKey:tt,getKey:nt,getOptionsForWebItem:function(e){var t=it(e),n=e.hasClass("ap-inline-dialog")?"inlineDialog":"dialog",i=rt(n,e);!i&&window._AP&&window._AP[n+"Options"]&&(i=q.extend({},window._AP[n+"Options"][t])||{});if(!i){i={};console.warn("no webitem "+n+"Options for "+t)}i.productContext=i.productContext||{};i.structuredContext=i.structuredContext||{};var o=at(e);if(o&&o.options){q.extend(i.productContext,o.options.productContext);q.extend(i.structuredContext,o.options.structuredContext);i.contextJwt=o.options.contextJwt}return i},getModuleOptionsByAddonAndModuleKey:ot,getConfigFromTarget:at},dt=new function(){var e=this;this._providers={};this.registerProvider=function(t,n){e._providers[t]=n};this.getProvider=function(t){return e._providers[t]}},ct=new(function(){function e(){this.moduleNamesToModules=new Map}e.prototype.registerModule=function(e,t){var n=e.getModuleRegistrationName();this.moduleNamesToModules.set(n,e)};e.prototype.getModuleByName=function(e){return this.moduleNamesToModules.get(e)};e.prototype.getProviderByModuleName=function(e){var t=this.moduleNamesToModules.get(e);return t&&t.isEnabled()?t.getProvider():void 0};return e}()),lt=function(){function e(){var e=this;this.create=function(e){return Ge(Ne.extensionConfigSanitizer(e))};this.dialog={create:function(e,t){var n=st.getModuleOptionsByAddonAndModuleKey("dialog",e.addon_key,e.key),i=q.extend({},n||{},t);W(e,i)},close:function(t,n){var i=e.getFrameworkAdaptor().getProviderByModuleName("dialog");if(i){oe.assertActiveDialogOrThrow(i,t);H("dialog.close",{addon_key:t},n);i.close()}else G()}};this.registerContentResolver={resolveByExtension:function(t){e._contentResolver=t;Se({callback:t})}};this.getContentResolver=function(){return e._contentResolver};this.registerProvider=function(e,t){dt.registerProvider(e,t)};this.getProvider=function(e){return dt.getProvider(e)};this.frameworkAdaptor=ct}var t=e.prototype;t.createExtension=function(e){e.options=e.options||{};e.options.noDom=!0;var t=Ne.createSimpleXdmExtension(e);Qe(t.extension);return t};t.registerExistingExtension=function(e,t){return z.registerExistingExtension(e,t)};t.setFrameworkAdaptor=function(e){this.frameworkAdaptor=e};t.getFrameworkAdaptor=function(){return this.frameworkAdaptor};t._cleanExtension=function(e){return q.pick(e,["id","addon_key","key","options","url"])};t.onIframeEstablished=function(e){e._wrapper=function(t){e.call({},{$el:t.$el,extension:this._cleanExtension(t.extension)})}.bind(this);h.register("after:iframe-bridge-established",e._wrapper)};t.offIframeEstablished=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");h.unregister("after:iframe-bridge-established",e._wrapper)};t.onIframeUnload=function(e){var t=this;h.register("after:iframe-unload",(function(n){e.call({},{$el:n.$el,extension:t._cleanExtension(n.extension)})}))};t.onPublicEventDispatched=function(e){e._wrapper=function(t){e.call({},{type:t.type,event:t.event,extension:this._cleanExtension(t.sender)})}.bind(this);h.register("after:event-public-dispatch",e._wrapper)};t.offPublicEventDispatched=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");h.unregister("after:event-public-dispatch",e._wrapper)};t.onKeyEvent=function(e,t,n,i){Q({extension_id:e,key:t,modifiers:n,callback:i})};t.offKeyEvent=function(e,t,n,i){Z({extension_id:e,key:t,modifiers:n,callback:i})};t.onFrameClick=function(e){if("function"!=typeof e)throw new Error("handleIframeClick must be a function");te(e)};t.offFrameClick=function(){ne()};t.destroy=function(e){re.notifyIframeDestroyed({id:e})};t.defineModule=function(e,t){Xe(e,t)};t.isModuleDefined=function(e){return z.isModuleDefined(e)};t.broadcastEvent=function(e,t,n){H(e,t,n)};t.getExtensions=function(e){return z.getExtensions(e)};t.trackDeprecatedMethodUsed=function(e,t){Ye(e,t)};t.trackAnalyticsEvent=function(e,t){Ze(e,t)};t.setJwtClockSkew=function(e){Pe(e)};t.isJwtExpired=function(e,t){return t?Ce.isJwtExpired(e):Oe.isJwtExpired(e)};t.hasJwt=function(e){return Oe.hasJwt(e)};t.getBooleanFeatureFlag=function(e){return _(e)};t.setExtensionConfigurationOptions=function(e,t){De.set(e,t)};t.getExtensionConfigurationOption=function(e){return De.get(e)};t.onIframeTimeout=function(e){e._wrapper=function(t){e.call({},{extension:this._cleanExtension(t.extension)})}.bind(this);h.register("after:iframe-bridge-timeout",e._wrapper)};t.offIframeTimeout=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");h.unregister("after:iframe-bridge-timeout",e._wrapper)};t.onIframePerformanceTelemetry=function(e){e._wrapper=function(t){e.call({},{metrics:t.metrics,extension:this._cleanExtension(t.extension)})}.bind(this);h.register("after:analytics-iframe-performance",e._wrapper)};t.offIframePerformanceTelemetry=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");h.unregister("after:analytics-iframe-performance",e._wrapper)};t.onIframeVisible=function(e){e._wrapper=function(t){e.call({},{extension:this._cleanExtension(t)})}.bind(this);h.register("after:iframe-visible",e._wrapper)};t.offIframeVisible=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");h.unregister("after:iframe-visible",e._wrapper)};return e}(),ut=new lt,ft="ap-dialog-",pt="ap-aui-dialog2",gt=new RegExp("^ap-dialog-[0-9A-Za-z]+$"),ht=["small","medium","large","xlarge","fullscreen","maximum"],mt="ap-aui-dialog-button",yt="aui-dialog2-footer-actions";function vt(){var e=AJS.LayerManager.global.getTopLayer();if(e&&gt.test(e.attr("id"))){var t=AJS.dialog2(e);t._id=t.$el.attr("id").replace(ft,"");return t}}function _t(e){var t=e.find(".header-control-panel");t.length||(t=e.find(".aui-dialog2-footer-actions"));return t}function xt(e,t){return _t(t).find(".aui-button").filter((function(){return qe.getIdentifier(this)===e}))}var bt=function(){function e(){}var t=e.prototype;t._renderHeaderCloseBtn=function(){var e=m("<a />").addClass("aui-dialog2-header-close"),t=m("<span />").addClass("aui-icon aui-icon-small aui-iconfont-close-dialog").text("Close");e.append(t);return e};t._renderFullScreenHeader=function(e,t){var n=m("<div />").addClass("header-title-container aui-item expanded"),i=m("<div />").append(m("<span />").addClass("header-title").text(t.header||""));n.append(i);e.append(n).append(this._renderHeaderActions(t.actions,t.extension));return e};t._renderHeader=function(e){var t=m("<header />").addClass("aui-dialog2-header");if("fullscreen"===e.size)return this._renderFullScreenHeader(t,e);if(e.header){var n=m("<h2 />").addClass("aui-dialog2-header-main").text(e.header);t.append(n)}t.append(this._renderHeaderCloseBtn());return t};t._renderHeaderActions=function(e,t){var n=m("<div />").addClass("aui-item header-control-panel");e[0].additionalClasses=["aui-icon","aui-icon-small","aui-iconfont-success"];e[1].additionalClasses=["aui-icon","aui-icon-small","aui-iconfont-close-dialog"];this._renderActionButtons(e,t).forEach((function(e){n.append(e)}));return n};t._renderContent=function(e){var t=m("<div />").addClass("aui-dialog2-content");e&&t.append(e);return t};t._renderFooter=function(e){var t=m("<footer />").addClass("aui-dialog2-footer");if("fullscreen"!==e.size){var n=this._renderFooterActions(e.actions,e.extension);t.append(n)}if(e.hint){var i=m("<div />").addClass("aui-dialog2-footer-hint").text(e.hint);t.append(i)}return t};t._renderActionButtons=function(e,t){var n=this,i=[];[].concat(e).forEach((function(e){i.push(n._renderDialogButton({text:e.text,name:e.name,type:e.type,additionalClasses:e.additionalClasses,custom:e.custom||!1,identifier:e.identifier,immutable:e.immutable,disabled:e.disabled||!1},t))}));return i};t._renderFooterActions=function(e,t){var n=m("<div />").addClass(yt);this._renderActionButtons(e,t).forEach((function(e){n.append(e)}));return n};t._renderDialogButton=function(e,t){e.additionalClasses=e.additionalClasses||[];e.additionalClasses.push(mt);e.custom&&e.additionalClasses.push("ap-dialog-custom-button");var n=qe.render(e);n.extension=t;return n};t.render=function(e){var t=q.extend({},e),n=oe.sanitizeOptions(e),i=m("<section />").attr({role:"dialog",id:ft+n.id});i.attr("data-aui-modal","true");i.data({"aui-remove-on-hide":!0,extension:n.extension});i.addClass("aui-layer aui-dialog2 "+pt);ht.indexOf(n.size)>=0&&i.addClass("aui-dialog2-"+n.size);if("fullscreen"===n.size||"maximum"===n.size){n.chrome&&i.addClass("ap-header-controls");i.addClass("aui-dialog2-maximum")}i.append(this._renderContent(n.$content));if(n.chrome){i.prepend(this._renderHeader({header:n.header,actions:n.actions,size:n.size}));i.append(this._renderFooter({extension:n.extension,actions:n.actions,hint:n.hint,size:n.size}))}else i.addClass("aui-dialog2-chromeless");var o=AJS.dialog2(i);o._id=n.id;"fullscreen"===n.size&&(n.height=n.width="100%");n.size&&"fullscreen"!==n.size||AJS.layer(i).changeSize(n.width,n.height);n.onHide&&o.on("hide",n.onHide);o.show();o.$el.data("extension",n.extension);o.$el.data("originalOptions",t);return i};t.setIframeDimensions=function(e){$e.resize("100%","100%",e)};t.getActive=function(){return vt()};t.buttonIsEnabled=function(e){var t=vt();if(t){var n=xt(e,t.$el);return qe.isEnabled(n)}};t.buttonIsVisible=function(e){var t=vt();if(t){var n=xt(e,t.$el);return qe.isVisible(n)}};t.getByExtension=function(e){var t;if("function"==typeof e)t=e;else{var n=Object.getOwnPropertyNames(e);t=function(t){var i=m(t).data("extension");return n.every((function(t){return i[t]===e[t]}))}}return m("."+pt).toArray().filter(t).map((function(e){return AJS.dialog2(e)}))};t.addButton=function(e,t){t.custom=!0;var n=this._renderDialogButton(t,e),i=this.getByExtension({addon_key:e.addon_key,key:e.key})[0].$el;_t(i).append(n);return i};return e}(),wt=new bt;h.register("iframe-bridge-established",(function(e){if(e.extension.options.isDialog){var t,n=ut.getFrameworkAdaptor().getProviderByModuleName("dialog");if(n){t=n.close;n.setButtonDisabled("submit",!1)}else{Y.toggleButton({identifier:"submit",enabled:!0});t=function(){Y.close({dialog:vt(),extension:e.extension})}}if(!e.extension.options.preventDialogCloseOnEscape){Q({extension_id:e.extension.id,key:27,callback:t});h.registerOnce("dialog-close",(function(t){Z({extension_id:e.extension.id,key:27})}))}}}));h.register("dialog-close-active",(function(e){var t=vt();t&&Y.close({customData:e.customData,dialog:t,extension:e.extension})}));h.register("dialog-close",(function(e){e.dialog&&e.dialog.hide()}));h.register("dialog-button-toggle",(function(e){var t=vt();if(t){var n=xt(e.identifier,t.$el);Re(n,!e.enabled)}}));h.register("dialog-button-toggle-visibility",(function(e){var t=vt();if(t){var n=xt(e.identifier,t.$el);ze(n,e.hidden)}}));h.register("button-clicked",(function(e){var t=e.$el;if(t.hasClass(mt)){var n=t.parents("."+pt),i=n.find("iframe");i.length&&i[0].bridgeEstablished?Y.clickButton(qe.getIdentifier(t),t,n.data("extension")):Y.close({dialog:vt(),extension:t.extension})}}));if(m.fn){h.register("iframe-create",(function(e){e.extension.options&&e.extension.options.isDialog&&wt.setIframeDimensions(e.extension.$el)}));h.register("dialog-button-add",(function(e){wt.addButton(e.extension,e.button)}));h.register("host-window-resize",q.debounce((function(){m("."+pt).each((function(e,t){var n=m(t),i=oe.sanitizeOptions(n.data("originalOptions"));t.style.width=i.width;t.style.height=i.height}))}),100))}ee({keyCode:27,callback:function(){Y.closeActive({customData:{},extension:null})}});var kt=new(function(){function e(){}var t=e.prototype;t.render=function(e,t){e.options=e.options||{};t=t||{};e.options.isDialog=!0;e.options.dialogId=t.id;_("com.atlassian.connect.acjs.iframe.acjs-981-handle-nested-dialog-close-event")&&(e.options.callbackExtensionId=e.callback_extension_id);e.options.preventDialogCloseOnEscape=!1===t.closeOnEscape;e.options.hostFrameOffset=t.hostFrameOffset;e.options.hideIframeUntilLoad=!0;var n=We.createExtension(e);return wt.render({extension:e,$content:n,chrome:t.chrome,width:t.width,height:t.height,size:t.size,header:t.header,hint:t.hint,submitText:t.submitText,cancelText:t.cancelText,buttons:t.buttons,onHide:t.onHide})};t.getActiveDialog=function(){return wt.getActive()};t.buttonIsEnabled=function(e){return wt.buttonIsEnabled(e)};t.buttonIsVisible=function(e){return wt.buttonIsVisible(e)};t.getByExtension=function(e){"string"==typeof e&&(e={id:e});return wt.getByExtension(e)};return e}());h.register("dialog-extension-open",(function(e){var t=e.extension,n=oe.sanitizeOptions(e.options),i=ut.getFrameworkAdaptor().getProviderByModuleName("dialog");if(i){var o=function(e){var n=t.key,i=t.addon_key,o={button:{identifier:e.identifier,name:e.identifier,text:e.text}};["submit","cancel"].indexOf(e.identifier)>=0&&H("dialog."+e.identifier,{addon_key:i,key:n},o);H("dialog.button.click",{addon_key:i,key:n},o)};t.options.preventDialogCloseOnEscape=!1===n.closeOnEscape;n.actions.map((function(e){return e.onClick=o.bind(null,e)}));i.create(n,t)}else kt.render(e.extension,e.options)}));var Et={};h.register("dialog-close",(function(e){if(e.dialog&&e.extension){var t={addon_key:e.extension.addon_key};_("com.atlassian.connect.acjs.iframe.acjs-981-handle-nested-dialog-close-event")&&(t.id=e.extension.options.callbackExtensionId);H("dialog.close",t,e.customData)}}));h.register("dialog-button-click",(function(e){var t={button:{name:qe.getName(e.$el),identifier:qe.getIdentifier(e.$el),text:qe.getText(e.$el)}},n={addon_key:e.extension.addon_key,key:e.extension.key};n.id=e.extension.id;e.$el.hasClass("ap-dialog-custom-button")||H("dialog."+t.button.name,n,t);H("dialog.button.click",n,t)}));var At=function(){function e(e,t){t=q.last(arguments);var n=ut.getFrameworkAdaptor(),i=n.getProviderByModuleName("dialog");if(i){oe.assertActiveDialogOrThrow(i,t._context.extension.addon_key);this.name=e;this.identifier=e}else{if(!kt.getActiveDialog())throw new Error("Failed to find an active dialog.");this.name=e;this.identifier=e;this.enabled=kt.buttonIsEnabled(e);this.hidden=!kt.buttonIsVisible(e)}}var t=e.prototype;t.enable=function(){this.setState({enabled:!0})};t.disable=function(){this.setState({enabled:!1})};t.isEnabled=function(e){e=q.last(arguments);var t=ut.getFrameworkAdaptor(),n=t.getProviderByModuleName("dialog");e(n?!n.isButtonDisabled(this.identifier):this.enabled)};t.toggle=function(){var e=ut.getFrameworkAdaptor().getProviderByModuleName("dialog");e?e.toggleButton(this.identifier):this.setState({enabled:!this.enabled})};t.setState=function(e){var t=ut.getFrameworkAdaptor().getProviderByModuleName("dialog");if(t)t.setButtonDisabled(this.identifier,!e.enabled);else{this.enabled=e.enabled;Y.toggleButton({identifier:this.identifier,enabled:this.enabled})}};t.trigger=function(e){e=q.last(arguments);this.enabled&&Y.dialogMessage({name:this.name,extension:e._context.extension})};t.isHidden=function(e){e=q.last(arguments);var t=ut.getFrameworkAdaptor(),n=t.getProviderByModuleName("dialog");e(n?n.isButtonHidden(this.identifier):this.hidden)};t.hide=function(){this.setHidden(!0)};t.show=function(){this.setHidden(!1)};t.setHidden=function(e){var t=ut.getFrameworkAdaptor().getProviderByModuleName("dialog");if(t)t.setButtonHidden(this.identifier,e);else{this.hidden=e;Y.toggleButtonVisibility({identifier:this.identifier,hidden:this.hidden})}};return e}();function Ct(e){return Et[e.extension.options.dialogId]}var It={create:{constructor:function(e,t){var n=(t=q.last(arguments))._id,i=t._context.extension,o={addon_key:i.addon_key,key:e.key,options:q.pick(i.options,["customData","productContext"])};_("com.atlassian.connect.acjs.iframe.acjs-981-handle-nested-dialog-close-event")&&(o.callback_extension_id=i.id);o.options.customData=e.customData;var r=oe.moduleOptionsFromGlobal(o.addon_key,o.key);"number"==typeof(r||{}).hostFrameOffset&&(o.options.hostFrameOffset=r.hostFrameOffset);(e=q.extend({},r||{},e)).id=n;oe.trackMultipleDialogOpening(o,e);W(o,e);this.customData=e.customData;Et[n]=this}},close:function(e,t){t=q.last(arguments);var n=ut.getFrameworkAdaptor(),i=n.getProviderByModuleName("dialog");if(i){oe.assertActiveDialogOrThrow(i,t._context.extension.addon_key);H("dialog.close",{addon_key:t._context.extension.addon_key},e);i.close()}else{var o;o=t._context.extension.options.isDialog?kt.getByExtension(t._context.extension.id)[0]:kt.getActiveDialog();Y.close({customData:e,dialog:o,extension:t._context.extension})}},getCustomData:function(e){var t=Ct((e=q.last(arguments))._context);e(t?t.customData:void 0)},getButton:{constructor:At,enable:At.prototype.enable,disable:At.prototype.disable,toggle:At.prototype.toggle,isEnabled:At.prototype.isEnabled,trigger:At.prototype.trigger,hide:At.prototype.hide,show:At.prototype.show,isHidden:At.prototype.isHidden},createButton:{constructor:function(e,t){t=q.last(arguments);var n=ut.getFrameworkAdaptor(),i=n.getProviderByModuleName("dialog");if(i){oe.assertActiveDialogOrThrow(i,t._context.extension.addon_key);i.createButton({identifier:e.identifier,text:e.text,hidden:!1,disabled:e.disabled||!1,onClick:function(){H("dialog.button.click",{addon_key:t._context.extension.addon_key,key:t._context.extension.key},{button:{identifier:e.identifier,text:e.text}})}})}else X({identifier:e.identifier,text:e.text},t._context.extension)}}};h.register("iframe-resize",(function(e){$e.resize(e.width,e.height,e.$el)}));h.register("iframe-size-to-parent",(function(e){var t,n=q.getIframeByExtensionId(e.extensionId);t=m(window).height()-n.offset().top-1;h.dispatch("iframe-resize",{width:"100%",height:t+"px",$el:n})}));h.register("hide-footer",(function(e){e&&m("#footer").css({display:"none"})}));window.addEventListener("resize",(function(e){h.dispatch("host-window-resize",e)}),!0);var Ot=function(e,t,n){var i;i=n.extension_id?q.getIframeByExtensionId(n.extension_id):n;h.dispatch("iframe-resize",{width:e,height:t,$el:i,extension:n.extension})},St=function(e,t){h.dispatch("iframe-size-to-parent",{hideFooter:t,extensionId:e})},Tt=function(e){h.dispatch("hide-footer",e)},Pt=q.debounce,Mt={},Dt=[],Lt={},Ft={getLocation:function(e){e=q.last(arguments);var t=dt.getProvider("get-location");e("function"==typeof t?t():window.location.href)},resize:function(e,t,n){n=q.last(arguments);var i=dt.getProvider("addon");if(i)i.resize(e,t,n._context);else{var o=n._context.extension.id,r=n._context.extension.options;if(-1!==Dt.indexOf(o)||r&&r.isDialog)return!1;Mt[o]||(Mt[o]=Pt((function(e,t,n){Ot(e,t,n._context)}),50));Mt[o](e,t,n)}return!0},sizeToParent:Pt((function(e,t){t=q.last(arguments);var n=dt.getProvider("addon");if(n)n.sizeToParent(e,t._context);else if(t._context.extension.options.isFullPage){q.getIframeByExtensionId(t._context.extension_id).addClass("full-size-general-page");St(t._context.extension_id,e);Lt[t._context.extension_id]={hideFooter:e}}else q.getIframeByExtensionId(t._context.extension_id).addClass("full-size-general-page-fail")})),hideFooter:function(e){e&&Tt(e)}},jt=function(e){delete Mt[e];delete Lt[e];-1!==Dt.indexOf(e)&&Dt.splice(Dt.indexOf(e),1)};h.register("host-window-resize",(function(e){Object.getOwnPropertyNames(Lt).forEach((function(e){St(e,Lt[e].hideFooter)}))}));h.register("after:iframe-unload",(function(e){jt(e.extension.id)}));h.register("after:iframe-destroyed",(function(e){jt(e.extension.extension.id)}));h.register("before:iframe-size-to-parent",(function(e){-1===Dt.indexOf(e.extensionId)&&Dt.push(e.extensionId)}));var Bt=function(e){h.dispatch("inline-dialog-refresh",{$el:e})},Nt=function(){h.dispatch("inline-dialog-close",{})},$t=function(e){h.dispatch("inline-dialog-opened",{$el:e.$el,trigger:e.trigger,extension:e.extension})},Jt={hide:function(e){e=q.last(arguments);var t=ut.getFrameworkAdaptor(),n=t.getProviderByModuleName("inlineDialog");n?n.hide(e._context):Nt()}},Rt="ac-message-container",zt=["generic","error","warning","success","info","hint"],Ht="ap-message-",Kt=new RegExp("^ap-message-[0-9A-fa-f]+$"),Ut={};function qt(e){return Kt.test(e)}var Vt=!1;function Wt(e,t,n,i){if(!Vt){m(document).on("aui-message-close",(function(e,t){var n=t.attr("id").replace(Ht,"");if(Ut[n]){m.isFunction(Ut[n].onCloseTrigger)&&Ut[n].onCloseTrigger();Ut[n]._destroy()}}));Vt=!0}var o=function(){var e=m("#"+Rt);e.length<1&&(e=m('<div id="'+Rt+'" />').appendTo("body"));return e}();i=function(e){var t={};"object"==typeof e&&["closeable","fadeout","delay","duration","id"].forEach((function(n){n in e&&(t[n]=e[n])}));return t}(i);m.extend(i,{title:t,body:AJS.escapeHtml(n)});if(zt.indexOf(e)<0)throw"Invalid message type. Must be: "+zt.join(", ");if(qt(i.id)){AJS.messages[e](o,i);o.css("margin-left","-"+o.innerWidth()/2+"px")}}function Gt(e,t,n,i,o){var r="AP.messages."+e;console.warn("DEPRECATED API - AP.messages."+e+" has been deprecated since ACJS 5.0 and will be removed in a future release. Use AP.flag.create instead.");Ye(r,o._context.extension);var a=ut.getFrameworkAdaptor().getProviderByModuleName("messages");if(a){var s=e,d=a[s];d||(a[s]=a.generic);d(t,n,i)}else Wt(e,t,n,i)}function Xt(e){return{constructor:function(t,n,i,o){var r=(o=q.last(arguments))._id;"string"!=typeof t&&(t="");"string"!=typeof n&&(n="");"object"!=typeof i&&(i={});i.id=Ht+r;Gt(e,t,n,i,o);Ut[r]=this}}}var Yt={clear:function(e){var t=Ht+e._id;if(qt(t)){var n=ut.getFrameworkAdaptor().getProviderByModuleName("messages");n?n.clear(t):m("#"+t).closeMessage()}},onClose:function(e,t){t=q.last(arguments);var n=e._id,i=ut.getFrameworkAdaptor(),o=i.getProviderByModuleName("messages");if(o){var r=Ht+e._id;o.onClose(r,t)}else Ut[n]&&(Ut[n].onCloseTrigger=t)},generic:Xt("generic"),error:Xt("error"),warning:Xt("warning"),success:Xt("success"),info:Xt("info"),hint:Xt("hint")},Qt={actionInvoked:function(e,t){h.dispatch("flag-action-invoked",{id:t,actionId:e})},open:function(e){h.dispatch("flag-open",{id:e})},close:function(e){h.dispatch("flag-close",{id:e})},closed:function(e){h.dispatch("flag-closed",{id:e})}},Zt="ap-flag-",en="ac-flag-actions",tn=function(){function e(){}var t=e.prototype;t.cleanKey=function(e){var t=new RegExp("^ap-flag-(.+)$"),n=e.match(t);return n&&n[1]?n[1]:null};t._toHtmlString=function(e){return"string"===m.type(e)?e:"object"===m.type(e)&&e instanceof m?e.html():void 0};t._renderBody=function(e){e=this._toHtmlString(e);var t=m("<div />").html(e);m("<p />").addClass(en).appendTo(t);return t.html()};t._renderActions=function(e,t,n){var i,o=e.find(".ac-flag-actions");n=n||{};Object.getOwnPropertyNames(n).forEach((function(e){i=m("<a />").attr("href","#").data({key:e,flag_id:t}).text(n[e]);o.append(i)}),this);return e};t.render=function(e){!function(){if(on)return;m(document).on("aui-flag-close",(function(e){var t=e.target.id,n=nn.cleanKey(t);Qt.closed(n)}));m(document).on("click",".ac-flag-actions",(function(e){var t=m(e.target),n=t.data("key"),i=t.data("flag_id");Qt.actionInvoked(n,i)}));on=!0}();var t=Zt+e.id,n=AJS.flag({type:e.type,title:e.title,body:this._renderBody(e.body),close:e.close});n.setAttribute("id",t);var i=m(n);this._renderActions(i,e.id,e.actions);i.addClass("ac-aui-flag");i.close=n.close;return i};t.close=function(e){document.getElementById(e).close()};return e}(),nn=new tn,on=!1;h.register("flag-close",(function(e){nn.close(e.id)}));var rn={},an=function(){function e(e,t){t=q.last(arguments);if("object"==typeof e){var n=t._id,i=ut.getFrameworkAdaptor(),o=i.getProviderByModuleName("flag");if(o){var r=[];"object"==typeof e.actions&&(r=Object.getOwnPropertyNames(e.actions).map((function(t){return{actionKey:t,actionText:e.actions[t],executeAction:Qt.actionInvoked.bind(null,t,n)}})));var a=e.type||"info",s={id:n,title:e.title,body:e.body,actions:r,onClose:Qt.closed,close:e.close,type:a.toLowerCase()};this.flag=o.create(s);var d=dt.getProvider("addon");d&&d.registerUnmountCallback&&d.registerUnmountCallback(this.close.bind(this),t._context)}else{this.flag=nn.render({type:e.type,title:e.title,body:AJS.escapeHtml(e.body),actions:e.actions,close:e.close,id:n});Qt.open(this.flag.attr("id"))}this.onTriggers={};this.extension=t._context.extension;rn[t._id]=this;t.call(null,t._id)}}e.prototype.close=function(){this.flag.close()};return e}();function sn(e,t,n){if(rn[e]){var i=rn[e].extension;(n=n||{}).flagIdentifier=e;H(t,{extension_id:i.extension_id},n)}}h.register("flag-closed",(function(e){sn(e.id,"flag.close");rn[e.id]&&delete rn[e.id]}));h.register("flag-action-invoked",(function(e){sn(e.id,"flag.action",{actionIdentifier:e.actionId})}));var dn,cn,ln={create:{constructor:an,close:an.prototype.close}},un={trackDeprecatedMethodUsed:function(e,t){t=q.last(arguments);Ye(e,t._context.extension)},trackIframePerformanceMetrics:function(e,t){t=q.last(arguments);et(e,t._context.extension)}};h.register("iframe-bridge-established",(function(e){if(e.extension.options.isFullPage){window.addEventListener("scroll",pn);dn=e.extension.id}}));h.register("iframe-destroyed",(function(e){fn()}));h.register("iframe-unload",(function(e){fn()}));function fn(){window.removeEventListener("scroll",pn);dn=void 0;cn=void 0}function pn(){var e=document.documentElement.scrollHeight,t=window.innerHeight,n=.1*e;window.pageYOffset<=n?gn("nearTop"):t+window.pageYOffset+n>=e?gn("nearBottom"):cn=void 0}function gn(e){if(cn!==e){H("scroll."+e,{id:dn},{});cn=e}}var hn={getPosition:function(e){if((e=q.last(arguments))._context.extension.options.isFullPage){var t=q.getIframeByExtensionId(e._context.extension_id),n=t.offset(),i=m(window);e({scrollY:i.scrollTop()-n.top,scrollX:i.scrollLeft()-n.left,width:window.innerWidth,height:window.innerHeight})}},setVerticalPosition:function(e,t){if((t=q.last(arguments))._context.extension.options&&t._context.extension.options.isFullPage){var n=q.getIframeByExtensionId(t._context.extension_id),i=n.offset();"number"==typeof e&&(document.documentElement.scrollTop=i.top+e)}}},mn=function(e,t,n){h.dispatch("dropdown-item-selected",{id:e,item:t,extension:n})};function yn(e){return e.map((function(e){if(e.list&&Array.isArray(e.list)){var t={heading:e.heading};t.items=e.list.map((function(e){return function(e){var t={};if("string"==typeof e)t.content=e;else{if(!e.text||"string"!=typeof e.text)throw new Error("Unknown dropdown list item format.");t.content=e.text;"boolean"==typeof e.disabled&&(t.disabled=e.disabled);void 0!==e.itemId&&(t.itemId=e.itemId)}return t}(e)}));return t}}))}var vn={create:function(e,t){t=q.last(arguments);if("object"==typeof e){var n=ut.getFrameworkAdaptor(),i=n.getProviderByModuleName("dropdown");if(i){var o=yn(e.list),r={dropdownId:e.dropdownId,dropdownGroups:o,dropdownItemNotifier:function(e){mn(e.dropdownId,e.item,t._context.extension)}};i.create(r,t._context);return r}}},showAt:function(e,t,n,i){var o=q.last(arguments),r={left:0,top:0},a=document.getElementById(o._context.extension_id);a?r=a.getBoundingClientRect():console.error("ACJS: no iframe found for dropdown");var s=ut.getFrameworkAdaptor(),d=s.getProviderByModuleName("dropdown");if(d){var c={dropdownId:e,x:t,y:n,width:i};d.showAt(c,{iframeDimensions:r,onItemSelection:function(e,t){mn(e,t,o._context.extension)}})}},hide:function(e){var t=ut.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.hide(e)},itemDisable:function(e,t){var n=ut.getFrameworkAdaptor().getProviderByModuleName("dropdown");n&&n.itemDisable(e,t)},itemEnable:function(e,t){var n=ut.getFrameworkAdaptor().getProviderByModuleName("dropdown");n&&n.itemEnable(e,t)}};h.register("dropdown-item-selected",(function(e){H("dropdown-item-selected",{addon_key:e.extension.addon_key,key:e.extension.key},{dropdownId:e.id,item:e.item})}));h.register("iframe-destroyed",(function(e){var t=ut.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.destroyByExtension(e.extension.extension_id)}));h.register("after:iframe-unload",(function(e){var t=ut.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.destroyByExtension(e.extension.extension_id)}));var _n,xn,bn,wn,kn,En={focus:function(){window.document.querySelector("a").focus({preventScroll:!0});window.document.querySelector("a").blur()},getSelectedText:(_n=function(e){if(_("com.atlassian.connect.acjs-vuln-610109-deprecate-getselectedtext"))e("");else{var t="",n=window.document.getSelection();n&&n.anchorNode&&3===n.anchorNode.nodeType&&(t=n.toString());e(t)}},xn="AP.host.getSelectedText()",kn=!1,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!kn&&"undefined"!=typeof console&&console.warn){kn=!0;console.warn("DEPRECATED API - "+xn+" has been deprecated "+(wn?"since ACJS "+wn:"in ACJS")+" and will be removed in a future release. "+(bn?"Use "+bn+" instead.":"No alternative will be provided."));var i=q.last(t);i&&i._context&&i._context.extension&&un.trackDeprecatedMethodUsed(xn,i)}return _n.apply(void 0,t)})},An=function(){function e(){this._webitems={};this._contentResolver=function(){}}var t=e.prototype;t.setContentResolver=function(e){this._contentResolver=e};t.requestContent=function(e){if(e.addon_key&&e.key)return this._contentResolver.call(null,q.extend({classifier:"json"},e))};t.getWebItemsBySelector=function(e){var t,n=this;Object.getOwnPropertyNames(this._webitems).some((function(i){var o=n._webitems[i];if(o.selector&&o.selector.trim()===e.trim()){t=o;return!0}return!1}));return t};t.setWebItem=function(e){return this._webitems[e.name]={name:e.name,selector:e.selector,triggers:e.triggers}};t._removeTriggers=function(e){var t=this,n=st.sanitizeTriggers(e.triggers);m((function(){m("body").off(n,e.selector,t._webitems[e.name]._on)}));delete this._webitems[e.name]._on};t._addTriggers=function(e){var t=st.sanitizeTriggers(e.triggers);e._on=function(t){t.preventDefault();var n=m(t.target).closest(e.selector),i=st.getConfigFromTarget(n),o=i&&i.url?i.url:void 0,r={addon_key:st.getExtensionKey(n),key:st.getKey(n),options:st.getOptionsForWebItem(n),url:o};"com.addonengine.analytics"!==r.addon_key||ut.isModuleDefined("analytics")?In.webitemInvoked(e,t,r):console.log("ACJS-1164 Dropping event "+t.type+" for plugin "+r.addon_key+" until AP.analytics loads...")};m((function(){m("body").on(t,e.selector,e._on);m("head").append('<style type="text/css">'+e.selector+".ap-link-webitem {pointer-events: auto;}</style>")}))};return e}(),Cn=new An;h.register("webitem-added",(function(e){Cn._addTriggers(e.webitem)}));h.register("content-resolver-register-by-extension",(function(e){Cn.setContentResolver(e.callback)}));document.addEventListener("aui-responsive-menu-item-created",(function(e){var t=e.detail.originalItem.querySelector('a[class*="ap-"]');if(t){var n=e.detail.newItem.querySelector("a");[].slice.call(t.classList).forEach((function(e){/^ap-/.test(e)&&n.classList.add(e)}))}}));var In={addWebItem:function(e){var t;if(Cn.getWebItemsBySelector(e.selector))return!1;t=Cn.setWebItem(e);h.dispatch("webitem-added",{webitem:t})},webitemInvoked:function(e,t,n){h.dispatch("webitem-invoked:"+e.name,{webitem:e,event:t,extension:n})}},On=function(e){h.dispatch("inline-dialog-extension",{$el:e.$el,extension:e.extension})},Sn=new(function(){function e(){}var t=e.prototype;t.resize=function(e){var t=q.stringToDimension(e.width),n=q.stringToDimension(e.height),i=e.$el.find(".contents");if(1===i.length){i.css({width:t,height:n});Bt(e.$el)}};t.refresh=function(e){e.is(":visible")&&e[0].popup.reset()};t._getInlineDialog=function(e){return AJS.InlineDialog(e)};t._renderContainer=function(){return m("<div />").addClass("aui-inline-dialog-contents")};t._displayInlineDialog=function(e){$t({$el:e.$el,trigger:e.trigger,extension:e.extension})};t.hideInlineDialog=function(e){e.hide()};t.closeInlineDialog=function(){m(".aui-inline-dialog").filter((function(){return m(this).find(".ap-iframe-container").length>0})).hide()};t.render=function(e){var t=this,n=m(document.getElementById("inline-dialog-"+e.id));0!==n.length&&n.remove();return AJS.InlineDialog(e.bindTo,e.id,(function(n,i,o){n.append(e.$content);t._displayInlineDialog({extension:e.extension,$el:n,trigger:i});o()}),e.inlineDialogOptions)};return e}());h.register("iframe-resize",(function(e){var t=e.$el.parents(".aui-inline-dialog");1===t.length&&Sn.resize({width:e.width,height:e.height,$el:t})}));h.register("inline-dialog-refresh",(function(e){Sn.refresh(e.$el)}));h.register("inline-dialog-hide",(function(e){Sn.hideInlineDialog(e.$el)}));h.register("inline-dialog-close",(function(e){Sn.closeInlineDialog()}));var Tn="inline-dialog-target-uid",Pn=new(function(){function e(){this._inlineDialogWebItemSpec={name:"inline-dialog",selector:".ap-inline-dialog",triggers:["mouseenter","click"]};this._inlineDialogWebItems={}}var t=e.prototype;t.getWebItem=function(){return this._inlineDialogWebItemSpec};t._createInlineDialog=function(e){return Sn.render({extension:e.extension,id:e.id,bindTo:e.$target,$content:m("<div />"),inlineDialogOptions:e.extension.options})};t.triggered=function(e){if("click"===e.event.type||e.extension.options.onHover){var t=m(e.event.currentTarget),n=t.data(Tn);this._createInlineDialog({id:n,extension:e.extension,$target:t,options:e.extension.options||{}}).show()}};t.opened=function(e){var t=e.$el.find("iframe");if(t&&1===t.length){var n=t.attr("src");if(n.length>0){var i=Oe.hasJwt(n);if(i&&!Oe.isJwtExpired(n)||!i)return!1}}var o=Cn.requestContent(e.extension);if(!o){console.warn("no content resolver found");return!1}o.then((function(t){t.options=t.options||{};q.extend(t.options,{autoresize:!0,widthinpx:!0});On({$el:e.$el,extension:t})}));return!0};t.addExtension=function(e){var t=Ge(e.extension);e.$el.empty().append(t)};t.createIfNotExists=function(e){var t=m(e.event.currentTarget),n=t.data(Tn);if(!n){n=st.uniqueId();t.data(Tn,n)}};return e}()),Mn=Pn.getWebItem();h.register("before:webitem-invoked:"+Mn.name,(function(e){Pn.createIfNotExists(e)}));h.register("webitem-invoked:"+Mn.name,(function(e){Pn.triggered(e)}));h.register("inline-dialog-opened",(function(e){Pn.opened(e)}));h.register("inline-dialog-extension",(function(e){Pn.addExtension(e)}));In.addWebItem(Mn);var Dn=["click"],Ln="dialog-target-uid",Fn={chrome:!0},jn=new(function(){function e(){this._dialogWebItem={name:"dialog",selector:".ap-dialog",triggers:Dn}}var t=e.prototype;t.getWebItem=function(){return this._dialogWebItem};t._dialogOptions=function(e){return q.extend({},Fn,e||{})};t.triggered=function(e){var t=m(e.event.currentTarget).data(Ln),n=this._dialogOptions(e.extension.options);n.id=t;W(e.extension,n)};t.createIfNotExists=function(e){var t=m(e.event.currentTarget),n=t.data(Ln);if(!n){n=st.uniqueId();t.data(Ln,n)}};return e}()),Bn=jn.getWebItem();h.register("webitem-invoked:"+Bn.name,(function(e){jn.triggered(e)}));h.register("before:webitem-invoked:"+Bn.name,jn.createIfNotExists);In.addWebItem(Bn);window._AP||(window._AP={});window._AP.version||(window._AP.version="5.3.59");z.defineModule("messages",Yt);z.defineModule("flag",ln);z.defineModule("dialog",It);z.defineModule("inlineDialog",Jt);z.defineModule("env",Ft);z.defineModule("events",V);z.defineModule("_analytics",un);z.defineModule("scrollPosition",hn);z.defineModule("dropdown",vn);z.defineModule("host",En);h.register("module-define-custom",(function(e){z.defineModule(e.name,e.methods)}));z.registerRequestNotifier((function(e){var t=function(){"req"===e.type?b.dispatch("bridge.invokemethod",{module:e.module,fn:e.fn,addonKey:e.addon_key,moduleKey:e.key}):"sub"===e.type&&b.dispatch("bridge.register-sub",{subAddonKey:e.sub.addon_key,subModuleKey:e.sub.key,addonKey:e.addon_key,moduleKey:e.key,blocked:e.blocked})};"function"==typeof window.requestIdleCallback?window.requestIdleCallback(t,{timeout:1e3}):t()}));z.setFeatureFlagGetter(_);return ut}));
}catch(e){WRMCB(e)};