WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-api-v5', location = 'v5/js/confluence/utils.js' */
define("ac/confluence/utils",["document"],(function(e){return{isFabricEditor:function(){return e.querySelectorAll("[data-fabric-mode]").length>0}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-api-v5', location = 'v5/js/confluence/macro/macro.js' */
define("ac/confluence/macro",["confluence/root","ajs","ac/confluence/utils"],(function(o,e,t){var r=void 0,a={};function n(){var o=require("confluence-macro-browser/macro-browser");void 0===o&&(o={getMacroName:function(o){},getMacroParams:function(o){},getMacroBody:function(){throw new Error("confluence-macro-browser/macro-browser is unavailable")}});return o}function c(o){const e=o.indexOf("=");if(e>0){return{key:o.slice(0,e),value:o.slice(e+1)}}return{}}function i(o){return o.split("|").reduce((function(o,e){const t=c(e);t.key&&(o[t.key]=t.value);return o}),{})}return{convertRawParamToObject:c,convertRawParamSeriesToObject:i,getMacroBody:function(o){if(e.DarkFeatures.isEnabled("fabric.editor.fix-get-macro-methods")){var t=o._context.extension.options.productContext["macro.id"],r=$('[data-macro-body][data-fabric-macro="'+t+'"]');if(r.length){o(r.attr("data-macro-body")||"");return}if(a&&"string"==typeof a.body){o(a.body);return}try{var c=n().getMacroBody();if(1==(d=$($.parseXML('<root xmlns:ac="guid">'+c+"</root>")).find("[ac\\:macro-id='"+t+"']")).length){o(d.html().replace('xmlns:ac="guid"',""));return}o(c);return}catch(r){if("false"===(u=o._context.extension.options.productContext)["macro.truncated"]){o(u["macro.body"]);return}var i=u["page.id"],s=u["page.version"];e.$.ajax({url:e.contextPath()+"/rest/api/content/"+i+"/history/"+s+"/macro/id/"+t,dataType:"json",success:function(e){o(e.body)}})}}else{if(a&&"string"==typeof a.body){o(a.body);return}try{var d;c=n().getMacroBody();t=o._context.extension.options.productContext["macro.id"];if(1==(d=$($.parseXML('<root xmlns:ac="guid">'+c+"</root>")).find("[ac\\:macro-id='"+t+"']")).length){o(d.html().replace('xmlns:ac="guid"',""));return}o(c);return}catch(r){var u;if("false"===(u=o._context.extension.options.productContext)["macro.truncated"]){o(u["macro.body"]);return}i=u["page.id"],s=u["page.version"];t=u["macro.id"];!function r(a,n){n=n||1e3;e.$.ajax({url:e.contextPath()+"/rest/api/content/"+i+"/history/"+s+"/macro/id/"+t,dataType:"json"}).then((function(e){o(e.body)})).fail((function(){a>0&&setTimeout((function(){r(--a)}),n)}))}(3,1e3)}}},closeCurrentMacroPropertyPanel:function(){e.Confluence.PropertyPanel.destroy()},setLastSelectedConnectMacroNode:function(o){a.locationToInsert=void 0;a.params=void 0;a.body=void 0;a.name=void 0;var e=n().getMacroName(o);r=void 0!==e?o:void 0},setUnsavedMacroData:function(o,e,t,r){a.body=e;a.params=t;a.locationToInsert=r;a.name=o},getMacroData:function(o){var e=o._context.extension.options.productContext["macro.id"],t=$('[data-fabric-macro="'+e+'"]');if(t.length)o(JSON.parse(t.attr("data-macro-parameters")||"{}"));else if(void 0===r&&a.params)o(a.params);else if(r)o(n().getMacroParams(r));else{o(i(o._context.extension.options.productContext[": = | RAW | = :"]||""))}},getCurrentMacroParameters:function(){return void 0===r?a.params:n().getMacroParams(r)},saveMacro:function(){return tinymce.confluence.MacroUtils.updateMacro.apply(this,arguments)},saveCurrentMacro:function(c,i){if(t.isFabricEditor()){return require("confluence-macro-browser/macro-browser-facade").insert({name:a.name,params:c,body:i})}if(void 0===r){a.params=c;a.body=i;var s={contentId:o.getContentId(),macro:{name:a.name,params:a.params,body:null===a.body?"":a.body}};e.Rte.getEditor().selection.moveToBookmark(a.locationToInsert);return tinymce.confluence.MacroUtils.insertMacro(s).done((function(o){r=o}))}var d=n().getMacroName(r);if(void 0!==d)return tinymce.confluence.MacroUtils.updateMacro(c,i,d,r).done((function(o){r=o}))}}}));
}catch(e){WRMCB(e)};